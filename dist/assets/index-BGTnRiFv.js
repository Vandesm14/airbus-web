var Rs=Object.defineProperty;var Xi=e=>{throw TypeError(e)};var Ts=(e,t,n)=>t in e?Rs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Ge=(e,t,n)=>Ts(e,typeof t!="symbol"?t+"":t,n),si=(e,t,n)=>t.has(e)||Xi("Cannot "+n);var h=(e,t,n)=>(si(e,t,"read from private field"),n?n.call(e):t.get(e)),X=(e,t,n)=>t.has(e)?Xi("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),J=(e,t,n,i)=>(si(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n),se=(e,t,n)=>(si(e,t,"access private method"),n);var xn=(e,t,n,i)=>({set _(s){J(e,t,s,n)},get _(){return h(e,t,i)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();const le={context:void 0,registry:void 0,done:!1,getContextId(){return Zi(this.context.count)},getNextContextId(){return Zi(this.context.count++)}};function Zi(e){const t=String(e),n=t.length-1;return le.context.id+(n?String.fromCharCode(96+n):"")+t}function vi(e){le.context=e}function Cs(){return{...le.context,id:le.getNextContextId(),count:0}}const As=(e,t)=>e===t,jt=Symbol("solid-proxy"),er=Symbol("solid-track"),Nn={equals:As};let Ir=qr;const vt=1,Wn=2,$r={owned:null,cleanups:null,context:null,owner:null},oi={};var ce=null;let ai=null,ks=null,he=null,Pe=null,pt=null,Hn=0;function Ps(e,t){const n=he,i=ce,s=e.length===0,a=t===void 0?i:t,u=s?$r:{owned:null,cleanups:null,context:a?a.context:null,owner:a},d=s?e:()=>e(()=>Ie(()=>Xn(u)));ce=u,he=null;try{return Pt(d,!0)}finally{he=n,ce=i}}function Te(e,t){t=t?Object.assign({},Nn,t):Nn;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},i=s=>(typeof s=="function"&&(s=s(n.value)),Ur(n,s));return[xr.bind(n),i]}function Sn(e,t,n){const i=Yn(e,t,!0,vt);hn(i)}function Ee(e,t,n){const i=Yn(e,t,!1,vt);hn(i)}function gt(e,t,n){Ir=Is;const i=Yn(e,t,!1,vt);i.user=!0,pt?pt.push(i):hn(i)}function ye(e,t,n){n=n?Object.assign({},Nn,n):Nn;const i=Yn(e,t,!0,0);return i.observers=null,i.observerSlots=null,i.comparator=n.equals||void 0,hn(i),xr.bind(i)}function Os(e){return e&&typeof e=="object"&&"then"in e}function Fr(e,t,n){let i,s,a;arguments.length===2&&typeof t=="object"||arguments.length===1?(i=!0,s=e,a=t||{}):(i=e,s=t,a={});let u=null,d=oi,m=null,C=!1,p="initialValue"in a,b=typeof i=="function"&&ye(i);const $=new Set,[F,E]=(a.storage||Te)(a.initialValue),[g,w]=Te(void 0),[y,D]=Te(void 0,{equals:!1}),[A,O]=Te(p?"ready":"unresolved");le.context&&(m=le.getNextContextId(),a.ssrLoadFrom==="initial"?d=a.initialValue:le.load&&le.has(m)&&(d=le.load(m)));function Q(U,Y,te,ae){return u===U&&(u=null,ae!==void 0&&(p=!0),(U===d||Y===d)&&a.onHydrated&&queueMicrotask(()=>a.onHydrated(ae,{value:Y})),d=oi,z(Y,te)),Y}function z(U,Y){Pt(()=>{Y===void 0&&E(()=>U),O(Y!==void 0?"errored":p?"ready":"unresolved"),w(Y);for(const te of $.keys())te.decrement();$.clear()},!1)}function N(){const U=Ls,Y=F(),te=g();if(te!==void 0&&!u)throw te;return he&&!he.user&&U&&Sn(()=>{y(),u&&(U.resolved||$.has(U)||(U.increment(),$.add(U)))}),Y}function x(U=!0){if(U!==!1&&C)return;C=!1;const Y=b?b():i;if(Y==null||Y===!1){Q(u,Ie(F));return}const te=d!==oi?d:Ie(()=>s(Y,{value:F(),refetching:U}));return Os(te)?(u=te,"value"in te?(te.status==="success"?Q(u,te.value,void 0,Y):Q(u,void 0,bi(te.value),Y),te):(C=!0,queueMicrotask(()=>C=!1),Pt(()=>{O(p?"refreshing":"pending"),D()},!1),te.then(ae=>Q(te,ae,void 0,Y),ae=>Q(te,void 0,bi(ae),Y)))):(Q(u,te,void 0,Y),te)}return Object.defineProperties(N,{state:{get:()=>A()},error:{get:()=>g()},loading:{get(){const U=A();return U==="pending"||U==="refreshing"}},latest:{get(){if(!p)return N();const U=g();if(U&&!u)throw U;return F()}}}),b?Sn(()=>x(!1)):x(!1),[N,{refetch:x,mutate:E}]}function Ms(e){return Pt(e,!1)}function Ie(e){if(he===null)return e();const t=he;he=null;try{return e()}finally{he=t}}function li(e,t,n){const i=Array.isArray(e);let s,a=n&&n.defer;return u=>{let d;if(i){d=Array(e.length);for(let C=0;C<e.length;C++)d[C]=e[C]()}else d=e();if(a)return a=!1,u;const m=Ie(()=>t(d,s,u));return s=d,m}}function Jn(e){gt(()=>Ie(e))}function Nt(e){return ce===null||(ce.cleanups===null?ce.cleanups=[e]:ce.cleanups.push(e)),e}function mi(){return he}function Ni(e,t){const n=Symbol("context");return{id:n,Provider:$s(n),defaultValue:e}}function Wi(e){let t;return ce&&ce.context&&(t=ce.context[e.id])!==void 0?t:e.defaultValue}function Ds(e){const t=ye(e),n=ye(()=>wi(t()));return n.toArray=()=>{const i=n();return Array.isArray(i)?i:i!=null?[i]:[]},n}let Ls;function xr(){if(this.sources&&this.state)if(this.state===vt)hn(this);else{const e=Pe;Pe=null,Pt(()=>zn(this),!1),Pe=e}if(he){const e=this.observers?this.observers.length:0;he.sources?(he.sources.push(this),he.sourceSlots.push(e)):(he.sources=[this],he.sourceSlots=[e]),this.observers?(this.observers.push(he),this.observerSlots.push(he.sources.length-1)):(this.observers=[he],this.observerSlots=[he.sources.length-1])}return this.value}function Ur(e,t,n){let i=e.value;return(!e.comparator||!e.comparator(i,t))&&(e.value=t,e.observers&&e.observers.length&&Pt(()=>{for(let s=0;s<e.observers.length;s+=1){const a=e.observers[s],u=ai&&ai.running;u&&ai.disposed.has(a),(u?!a.tState:!a.state)&&(a.pure?Pe.push(a):pt.push(a),a.observers&&Br(a)),u||(a.state=vt)}if(Pe.length>1e6)throw Pe=[],new Error},!1)),t}function hn(e){if(!e.fn)return;Xn(e);const t=Hn;Es(e,e.value,t)}function Es(e,t,n){let i;const s=ce,a=he;he=ce=e;try{i=e.fn(t)}catch(u){return e.pure&&(e.state=vt,e.owned&&e.owned.forEach(Xn),e.owned=null),e.updatedAt=n+1,jr(u)}finally{he=a,ce=s}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?Ur(e,i):e.value=i,e.updatedAt=n)}function Yn(e,t,n,i=vt,s){const a={fn:e,state:i,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:ce,context:ce?ce.context:null,pure:n};return ce===null||ce!==$r&&(ce.owned?ce.owned.push(a):ce.owned=[a]),a}function Qn(e){if(e.state===0)return;if(e.state===Wn)return zn(e);if(e.suspense&&Ie(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<Hn);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===vt)hn(e);else if(e.state===Wn){const i=Pe;Pe=null,Pt(()=>zn(e,t[0]),!1),Pe=i}}function Pt(e,t){if(Pe)return e();let n=!1;t||(Pe=[]),pt?n=!0:pt=[],Hn++;try{const i=e();return _s(n),i}catch(i){n||(pt=null),Pe=null,jr(i)}}function _s(e){if(Pe&&(qr(Pe),Pe=null),e)return;const t=pt;pt=null,t.length&&Pt(()=>Ir(t),!1)}function qr(e){for(let t=0;t<e.length;t++)Qn(e[t])}function Is(e){let t,n=0;for(t=0;t<e.length;t++){const i=e[t];i.user?e[n++]=i:Qn(i)}if(le.context){if(le.count){le.effects||(le.effects=[]),le.effects.push(...e.slice(0,n));return}else le.effects&&(e=[...le.effects,...e],n+=le.effects.length,delete le.effects);vi()}for(t=0;t<n;t++)Qn(e[t])}function zn(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const i=e.sources[n];if(i.sources){const s=i.state;s===vt?i!==t&&(!i.updatedAt||i.updatedAt<Hn)&&Qn(i):s===Wn&&zn(i,t)}}}function Br(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=Wn,n.pure?Pe.push(n):pt.push(n),n.observers&&Br(n))}}function Xn(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),i=e.sourceSlots.pop(),s=n.observers;if(s&&s.length){const a=s.pop(),u=n.observerSlots.pop();i<s.length&&(a.sourceSlots[u]=i,s[i]=a,n.observerSlots[i]=u)}}if(e.owned){for(t=e.owned.length-1;t>=0;t--)Xn(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function bi(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function jr(e,t=ce){throw bi(e)}function wi(e){if(typeof e=="function"&&!e.length)return wi(e());if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++){const i=wi(e[n]);Array.isArray(i)?t.push.apply(t,i):t.push(i)}return t}return e}function $s(e,t){return function(i){let s;return Ee(()=>s=Ie(()=>(ce.context={...ce.context,[e]:i.value},Ds(()=>i.children))),void 0),s}}let Fs=!1;function pe(e,t){if(Fs&&le.context){const n=le.context;vi(Cs());const i=Ie(()=>e(t||{}));return vi(n),i}return Ie(()=>e(t||{}))}let xs=0;function Nr(){return le.context?le.getNextContextId():`cl-${xs++}`}const Us=e=>`Stale read from <${e}>.`;function Wt(e){const t=e.keyed,n=ye(()=>e.when,void 0,{equals:(i,s)=>t?i===s:!i==!s});return ye(()=>{const i=n();if(i){const s=e.children;return typeof s=="function"&&s.length>0?Ie(()=>s(t?i:()=>{if(!Ie(n))throw Us("Show");return e.when})):s}return e.fallback},void 0,void 0)}function qs(e,t,n){let i=n.length,s=t.length,a=i,u=0,d=0,m=t[s-1].nextSibling,C=null;for(;u<s||d<a;){if(t[u]===n[d]){u++,d++;continue}for(;t[s-1]===n[a-1];)s--,a--;if(s===u){const p=a<i?d?n[d-1].nextSibling:n[a-d]:m;for(;d<a;)e.insertBefore(n[d++],p)}else if(a===d)for(;u<s;)(!C||!C.has(t[u]))&&t[u].remove(),u++;else if(t[u]===n[a-1]&&n[d]===t[s-1]){const p=t[--s].nextSibling;e.insertBefore(n[d++],t[u++].nextSibling),e.insertBefore(n[--a],p),t[s]=n[a]}else{if(!C){C=new Map;let b=d;for(;b<a;)C.set(n[b],b++)}const p=C.get(t[u]);if(p!=null)if(d<p&&p<a){let b=u,$=1,F;for(;++b<s&&b<a&&!((F=C.get(t[b]))==null||F!==p+$);)$++;if($>p-d){const E=t[u];for(;d<p;)e.insertBefore(n[d++],E)}else e.replaceChild(n[d++],t[u++])}else u++;else t[u++].remove()}}}const tr="_$DX_DELEGATE";function Bs(e,t,n,i={}){let s;return Ps(a=>{s=a,t===document?e():ee(t,e(),t.firstChild?null:void 0,n)},i.owner),()=>{s(),t.textContent=""}}function de(e,t,n){let i;const s=()=>{const u=document.createElement("template");return u.innerHTML=e,u.content.firstChild},a=()=>(i||(i=s())).cloneNode(!0);return a.cloneNode=a,a}function Dn(e,t=window.document){const n=t[tr]||(t[tr]=new Set);for(let i=0,s=e.length;i<s;i++){const a=e[i];n.has(a)||(n.add(a),t.addEventListener(a,Ns))}}function js(e,t){Wr(e)||(t==null?e.removeAttribute("class"):e.className=t)}function Si(e,t,n){return Ie(()=>e(t,n))}function ee(e,t,n,i){if(n!==void 0&&!i&&(i=[]),typeof t!="function")return Vn(e,t,i,n);Ee(s=>Vn(e,t(),s,n),i)}function Wr(e){return!!le.context&&!le.done&&(!e||e.isConnected)}function Ns(e){if(le.registry&&le.events&&le.events.find(([i,s])=>s===e))return;const t=`$$${e.type}`;let n=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==n&&Object.defineProperty(e,"target",{configurable:!0,value:n}),Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return n||document}}),le.registry&&!le.done&&(le.done=_$HY.done=!0);n;){const i=n[t];if(i&&!n.disabled){const s=n[`${t}Data`];if(s!==void 0?i.call(n,s,e):i.call(n,e),e.cancelBubble)return}n=n._$host||n.parentNode||n.host}}function Vn(e,t,n,i,s){const a=Wr(e);if(a){!n&&(n=[...e.childNodes]);let m=[];for(let C=0;C<n.length;C++){const p=n[C];p.nodeType===8&&p.data.slice(0,2)==="!$"?p.remove():m.push(p)}n=m}for(;typeof n=="function";)n=n();if(t===n)return n;const u=typeof t,d=i!==void 0;if(e=d&&n[0]&&n[0].parentNode||e,u==="string"||u==="number"){if(a||u==="number"&&(t=t.toString(),t===n))return n;if(d){let m=n[0];m&&m.nodeType===3?m.data!==t&&(m.data=t):m=document.createTextNode(t),n=zt(e,n,i,m)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t}else if(t==null||u==="boolean"){if(a)return n;n=zt(e,n,i)}else{if(u==="function")return Ee(()=>{let m=t();for(;typeof m=="function";)m=m();n=Vn(e,m,n,i)}),()=>n;if(Array.isArray(t)){const m=[],C=n&&Array.isArray(n);if(Ri(m,t,n,s))return Ee(()=>n=Vn(e,m,n,i,!0)),()=>n;if(a){if(!m.length)return n;if(i===void 0)return n=[...e.childNodes];let p=m[0];if(p.parentNode!==e)return n;const b=[p];for(;(p=p.nextSibling)!==i;)b.push(p);return n=b}if(m.length===0){if(n=zt(e,n,i),d)return n}else C?n.length===0?nr(e,m,i):qs(e,n,m):(n&&zt(e),nr(e,m));n=m}else if(t.nodeType){if(a&&t.parentNode)return n=d?[t]:t;if(Array.isArray(n)){if(d)return n=zt(e,n,i,t);zt(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}}return n}function Ri(e,t,n,i){let s=!1;for(let a=0,u=t.length;a<u;a++){let d=t[a],m=n&&n[e.length],C;if(!(d==null||d===!0||d===!1))if((C=typeof d)=="object"&&d.nodeType)e.push(d);else if(Array.isArray(d))s=Ri(e,d,m)||s;else if(C==="function")if(i){for(;typeof d=="function";)d=d();s=Ri(e,Array.isArray(d)?d:[d],Array.isArray(m)?m:[m])||s}else e.push(d),s=!0;else{const p=String(d);m&&m.nodeType===3&&m.data===p?e.push(m):e.push(document.createTextNode(p))}}return s}function nr(e,t,n=null){for(let i=0,s=t.length;i<s;i++)e.insertBefore(t[i],n)}function zt(e,t,n,i){if(n===void 0)return e.textContent="";const s=i||document.createTextNode("");if(t.length){let a=!1;for(let u=t.length-1;u>=0;u--){const d=t[u];if(s!==d){const m=d.parentNode===e;!a&&!u?m?e.replaceChild(s,d):e.insertBefore(s,n):m&&d.remove()}else a=!0}}else e.insertBefore(s,n);return[s]}const ir=!1,Je={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};let Ws=0;function yt(e,t){const n=`atom${++Ws}`,i={toString(){return(Je?"production":void 0)!=="production"&&this.debugLabel?n+":"+this.debugLabel:n}};return typeof e=="function"?i.read=e:(i.init=e,i.read=Qs,i.write=zs),i}function Qs(e){return e(this)}function zs(e,t,n){return t(this,typeof n=="function"?n(e(this)):n)}const rr=(e,t)=>e.unstable_is?e.unstable_is(t):t===e,ui=e=>"init"in e,di=e=>!!e.write,Rn=Symbol((Je?"production":void 0)!=="production"?"CONTINUE_PROMISE":""),Qi="pending",Vs="fulfilled",Ks="rejected",Gs=e=>typeof e=="object"&&e!==null&&Rn in e,Un=new WeakMap,Hs=(e,t,n)=>{if(!Un.has(e)){let i;const s=new Promise((a,u)=>{let d=e;const m=p=>b=>{d===p&&(s.status=Vs,s.value=b,a(b),n())},C=p=>b=>{d===p&&(s.status=Ks,s.reason=b,u(b),n())};e.then(m(e),C(e)),i=(p,b)=>{p&&(Un.set(p,s),d=p,p.then(m(p),C(p)),t(),t=b)}});s.status=Qi,s[Rn]=i,Un.set(e,s)}return Un.get(e)},Js=e=>typeof(e==null?void 0:e.then)=="function",sr=e=>"v"in e||"e"in e,qn=e=>{if("e"in e)throw e.e;if((Je?"production":void 0)!=="production"&&!("v"in e))throw new Error("[Bug] atom state is not initialized");return e.v},jn=e=>{const t=e.v;return Gs(t)&&t.status===Qi?t:null},Qr=(e,t,n)=>{n.p.has(e)||(n.p.add(e),t.then(()=>{n.p.delete(e)},()=>{n.p.delete(e)}))},or=(e,t,n,i,s)=>{var a;if((Je?"production":void 0)!=="production"&&i===t)throw new Error("[Bug] atom cannot depend on itself");n.d.set(i,s.n);const u=jn(n);u&&Qr(t,u,s),(a=s.m)==null||a.t.add(t),e&&Ys(e,i,t)},Vt=()=>[new Map,new Map,new Set],fi=(e,t,n)=>{e[0].has(t)||e[0].set(t,new Set),e[1].set(t,n)},Ys=(e,t,n)=>{const i=e[0].get(t);i&&i.add(n)},Xs=(e,t)=>e[0].get(t),ar=(e,t)=>{e[2].add(t)},Lt=e=>{for(;e[1].size||e[2].size;){e[0].clear();const t=new Set(e[1].values());e[1].clear();const n=new Set(e[2]);e[2].clear(),t.forEach(i=>{var s;return(s=i.m)==null?void 0:s.l.forEach(a=>a())}),n.forEach(i=>i())}},zr=e=>{let t;(Je?"production":void 0)!=="production"&&(t=new Set);const n=(g,w,y,D=()=>{},A=()=>{})=>{const O="v"in w,Q=w.v,z=jn(w);if(Js(y))if(z)z!==y&&(z[Rn](y,D),++w.n);else{const N=Hs(y,D,A);if(N.status===Qi)for(const x of w.d.keys())Qr(g,N,e(x,w));w.v=N,delete w.e}else z&&z[Rn](Promise.resolve(y),D),w.v=y,delete w.e;(!O||!Object.is(Q,w.v))&&++w.n},i=(g,w,y,D)=>{if(!(D!=null&&D(w))&&sr(y)&&(y.m||Array.from(y.d).every(([x,U])=>i(g,x,e(x,y),D).n===U)))return y;y.d.clear();let A=!0;const O=x=>{if(rr(w,x)){const Y=e(x,y);if(!sr(Y))if(ui(x))n(x,Y,x.init);else throw new Error("no atom init");return qn(Y)}const U=i(g,x,e(x,y),D);if(A)or(g,w,y,x,U);else{const Y=Vt();or(Y,w,y,x,U),C(Y,w,y),Lt(Y)}return qn(U)};let Q,z;const N={get signal(){return Q||(Q=new AbortController),Q.signal},get setSelf(){return(Je?"production":void 0)!=="production"&&!di(w)&&console.warn("setSelf function cannot be used with read-only atom"),!z&&di(w)&&(z=(...x)=>{if((Je?"production":void 0)!=="production"&&A&&console.warn("setSelf function cannot be called in sync"),!A)return m(w,...x)}),z}};try{const x=w.read(O,N);return n(w,y,x,()=>Q==null?void 0:Q.abort(),()=>{if(y.m){const U=Vt();C(U,w,y),Lt(U)}}),y}catch(x){return delete y.v,y.e=x,++y.n,y}finally{A=!1}},s=g=>qn(i(void 0,g,e(g))),a=(g,w,y)=>{var D,A;const O=new Map;for(const Q of((D=y.m)==null?void 0:D.t)||[])O.set(Q,e(Q,y));for(const Q of y.p)O.set(Q,e(Q,y));return(A=Xs(g,w))==null||A.forEach(Q=>{O.set(Q,e(Q,y))}),O},u=(g,w,y)=>{const D=[],A=new Set,O=(N,x)=>{if(!A.has(N)){A.add(N);for(const[U,Y]of a(g,N,x))N!==U&&O(U,Y);D.push([N,x,x.n])}};O(w,y);const Q=new Set([w]),z=N=>A.has(N);for(let N=D.length-1;N>=0;--N){const[x,U,Y]=D[N];let te=!1;for(const ae of U.d.keys())if(ae!==x&&Q.has(ae)){te=!0;break}te&&(i(g,x,U,z),C(g,x,U),Y!==U.n&&(fi(g,x,U),Q.add(x))),A.delete(x)}},d=(g,w,y,...D)=>{const A=z=>qn(i(g,z,e(z,y))),O=(z,...N)=>{const x=e(z,y);let U;if(rr(w,z)){if(!ui(z))throw new Error("atom not writable");const Y="v"in x,te=x.v,ae=N[0];n(z,x,ae),C(g,z,x),(!Y||!Object.is(te,x.v))&&(fi(g,z,x),u(g,z,x))}else U=d(g,z,x,...N);return Lt(g),U};return w.write(A,O,...D)},m=(g,...w)=>{const y=Vt(),D=d(y,g,e(g),...w);return Lt(y),D},C=(g,w,y)=>{if(y.m&&!jn(y)){for(const D of y.d.keys())y.m.d.has(D)||(p(g,D,e(D,y)).t.add(w),y.m.d.add(D));for(const D of y.m.d||[])if(!y.d.has(D)){y.m.d.delete(D);const A=b(g,D,e(D,y));A==null||A.t.delete(w)}}},p=(g,w,y)=>{if(!y.m){i(g,w,y);for(const D of y.d.keys())p(g,D,e(D,y)).t.add(w);if(y.m={l:new Set,d:new Set(y.d.keys()),t:new Set},(Je?"production":void 0)!=="production"&&t.add(w),di(w)&&w.onMount){const D=y.m,{onMount:A}=w;ar(g,()=>{const O=A((...Q)=>d(g,w,y,...Q));O&&(D.u=O)})}}return y.m},b=(g,w,y)=>{if(y.m&&!y.m.l.size&&!Array.from(y.m.t).some(D=>{var A;return(A=e(D,y).m)==null?void 0:A.d.has(w)})){const D=y.m.u;D&&ar(g,D),delete y.m,(Je?"production":void 0)!=="production"&&t.delete(w);for(const O of y.d.keys()){const Q=b(g,O,e(O,y));Q==null||Q.t.delete(w)}const A=jn(y);A&&A[Rn](void 0,()=>{});return}return y.m},E={get:s,set:m,sub:(g,w)=>{const y=Vt(),D=e(g),A=p(y,g,D);Lt(y);const O=A.l;return O.add(w),()=>{O.delete(w);const Q=Vt();b(Q,g,D),Lt(Q)}},unstable_derive:g=>zr(...g(e))};return(Je?"production":void 0)!=="production"&&Object.assign(E,{dev4_get_internal_weak_map:()=>({get:w=>{const y=e(w);if(y.n!==0)return y}}),dev4_get_mounted_atoms:()=>t,dev4_restore_atoms:w=>{const y=Vt();for(const[D,A]of w)if(ui(D)){const O=e(D),Q="v"in O,z=O.v;n(D,O,A),C(y,D,O),(!Q||!Object.is(z,O.v))&&(fi(y,D,O),u(y,D,O))}Lt(y)}}),E},Zs=()=>{const e=new WeakMap;return zr(n=>{let i=e.get(n);return i||(i={d:new Map,p:new Set,n:0},e.set(n,i)),i})};let yn;const eo=()=>(yn||(yn=Zs(),(Je?"production":void 0)!=="production"&&(globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=yn),globalThis.__JOTAI_DEFAULT_STORE__!==yn&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"))),yn);var to=Ni(void 0);function Vr(e){return Wi(to)||eo()}function no(e,t){const n=Vr();function i(...s){return n.set(e,...s)}return i}const Ti=Symbol("store-raw"),Ht=Symbol("store-node"),ft=Symbol("store-has"),Kr=Symbol("store-self");function Gr(e){let t=e[jt];if(!t&&(Object.defineProperty(e,jt,{value:t=new Proxy(e,so)}),!Array.isArray(e))){const n=Object.keys(e),i=Object.getOwnPropertyDescriptors(e);for(let s=0,a=n.length;s<a;s++){const u=n[s];i[u].get&&Object.defineProperty(e,u,{enumerable:i[u].enumerable,get:i[u].get.bind(t)})}}return t}function Ot(e){let t;return e!=null&&typeof e=="object"&&(e[jt]||!(t=Object.getPrototypeOf(e))||t===Object.prototype||Array.isArray(e))}function Mt(e,t=new Set){let n,i,s,a;if(n=e!=null&&e[Ti])return n;if(!Ot(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let u=0,d=e.length;u<d;u++)s=e[u],(i=Mt(s,t))!==s&&(e[u]=i)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const u=Object.keys(e),d=Object.getOwnPropertyDescriptors(e);for(let m=0,C=u.length;m<C;m++)a=u[m],!d[a].get&&(s=e[a],(i=Mt(s,t))!==s&&(e[a]=i))}return e}function Kn(e,t){let n=e[t];return n||Object.defineProperty(e,t,{value:n=Object.create(null)}),n}function Tn(e,t,n){if(e[t])return e[t];const[i,s]=Te(n,{equals:!1,internal:!0});return i.$=s,e[t]=i}function io(e,t){const n=Reflect.getOwnPropertyDescriptor(e,t);return!n||n.get||!n.configurable||t===jt||t===Ht||(delete n.value,delete n.writable,n.get=()=>e[jt][t]),n}function Hr(e){mi()&&Tn(Kn(e,Ht),Kr)()}function ro(e){return Hr(e),Reflect.ownKeys(e)}const so={get(e,t,n){if(t===Ti)return e;if(t===jt)return n;if(t===er)return Hr(e),n;const i=Kn(e,Ht),s=i[t];let a=s?s():e[t];if(t===Ht||t===ft||t==="__proto__")return a;if(!s){const u=Object.getOwnPropertyDescriptor(e,t);mi()&&(typeof a!="function"||e.hasOwnProperty(t))&&!(u&&u.get)&&(a=Tn(i,t,a)())}return Ot(a)?Gr(a):a},has(e,t){return t===Ti||t===jt||t===er||t===Ht||t===ft||t==="__proto__"?!0:(mi()&&Tn(Kn(e,ft),t)(),t in e)},set(){return!0},deleteProperty(){return!0},ownKeys:ro,getOwnPropertyDescriptor:io};function je(e,t,n,i=!1){if(!i&&e[t]===n)return;const s=e[t],a=e.length;n===void 0?(delete e[t],e[ft]&&e[ft][t]&&s!==void 0&&e[ft][t].$()):(e[t]=n,e[ft]&&e[ft][t]&&s===void 0&&e[ft][t].$());let u=Kn(e,Ht),d;if((d=Tn(u,t,s))&&d.$(()=>n),Array.isArray(e)&&e.length!==a){for(let m=e.length;m<a;m++)(d=u[m])&&d.$();(d=Tn(u,"length",a))&&d.$(e.length)}(d=u[Kr])&&d.$()}function Jr(e,t){const n=Object.keys(t);for(let i=0;i<n.length;i+=1){const s=n[i];je(e,s,t[s])}}function oo(e,t){if(typeof t=="function"&&(t=t(e)),t=Mt(t),Array.isArray(t)){if(e===t)return;let n=0,i=t.length;for(;n<i;n++){const s=t[n];e[n]!==s&&je(e,n,s)}je(e,"length",i)}else Jr(e,t)}function bn(e,t,n=[]){let i,s=e;if(t.length>1){i=t.shift();const u=typeof i,d=Array.isArray(e);if(Array.isArray(i)){for(let m=0;m<i.length;m++)bn(e,[i[m]].concat(t),n);return}else if(d&&u==="function"){for(let m=0;m<e.length;m++)i(e[m],m)&&bn(e,[m].concat(t),n);return}else if(d&&u==="object"){const{from:m=0,to:C=e.length-1,by:p=1}=i;for(let b=m;b<=C;b+=p)bn(e,[b].concat(t),n);return}else if(t.length>1){bn(e[i],t,[i].concat(n));return}s=e[i],n=[i].concat(n)}let a=t[0];typeof a=="function"&&(a=a(s,n),a===s)||i===void 0&&a==null||(a=Mt(a),i===void 0||Ot(s)&&Ot(a)&&!Array.isArray(a)?Jr(s,a):je(e,i,a))}function Yr(...[e,t]){const n=Mt(e||{}),i=Array.isArray(n),s=Gr(n);function a(...u){Ms(()=>{i&&u.length===1?oo(n,u[0]):bn(n,u)})}return[s,a]}const Ci=Symbol("store-root");function Kt(e,t,n,i,s){const a=t[n];if(e===a)return;const u=Array.isArray(e);if(n!==Ci&&(!Ot(e)||!Ot(a)||u!==Array.isArray(a)||s&&e[s]!==a[s])){je(t,n,e);return}if(u){if(e.length&&a.length&&(!i||s&&e[0]&&e[0][s]!=null)){let C,p,b,$,F,E,g,w;for(b=0,$=Math.min(a.length,e.length);b<$&&(a[b]===e[b]||s&&a[b]&&e[b]&&a[b][s]===e[b][s]);b++)Kt(e[b],a,b,i,s);const y=new Array(e.length),D=new Map;for($=a.length-1,F=e.length-1;$>=b&&F>=b&&(a[$]===e[F]||s&&a[b]&&e[b]&&a[$][s]===e[F][s]);$--,F--)y[F]=a[$];if(b>F||b>$){for(p=b;p<=F;p++)je(a,p,e[p]);for(;p<e.length;p++)je(a,p,y[p]),Kt(e[p],a,p,i,s);a.length>e.length&&je(a,"length",e.length);return}for(g=new Array(F+1),p=F;p>=b;p--)E=e[p],w=s&&E?E[s]:E,C=D.get(w),g[p]=C===void 0?-1:C,D.set(w,p);for(C=b;C<=$;C++)E=a[C],w=s&&E?E[s]:E,p=D.get(w),p!==void 0&&p!==-1&&(y[p]=a[C],p=g[p],D.set(w,p));for(p=b;p<e.length;p++)p in y?(je(a,p,y[p]),Kt(e[p],a,p,i,s)):je(a,p,e[p])}else for(let C=0,p=e.length;C<p;C++)Kt(e[C],a,C,i,s);a.length>e.length&&je(a,"length",e.length);return}const d=Object.keys(e);for(let C=0,p=d.length;C<p;C++)Kt(e[d[C]],a,d[C],i,s);const m=Object.keys(a);for(let C=0,p=m.length;C<p;C++)e[m[C]]===void 0&&je(a,m[C],void 0)}function zi(e,t={}){const{merge:n,key:i="id"}=t,s=Mt(e);return a=>{if(!Ot(a)||!Ot(s))return s;const u=Kt(s,{[Ci]:a},Ci,n,i);return u===void 0?a:u}}function lr(e){const[t,n]=Yr({value:e});return[()=>t.value,i=>{const s=Mt(t.value);return typeof i=="function"&&(i=i(s)),n("value",zi(i)),t.value}]}function ao(e){return e instanceof Promise}function lo(e,t){const n=Vr(),i=n.get(e);if(ao(i)){const[d,{refetch:m}]=Fr(()=>n.get(e),{storage:lr}),C=n.sub(e,()=>m());return Nt(()=>C()),d}const[s,a]=lr(i),u=n.sub(e,()=>{const d=n.get(e);a(()=>d)});return Nt(()=>u()),s}function Se(e,t){return[lo(e),no(e)]}var fe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function uo(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Xr={exports:{}};(function(e){/**
 * {@link https://github.com/muaz-khan/RecordRTC|RecordRTC} is a WebRTC JavaScript library for audio/video as well as screen activity recording. It supports Chrome, Firefox, Opera, Android, and Microsoft Edge. Platforms: Linux, Mac and Windows. 
 * @summary Record audio, video or screen inside the browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTC
 * @class
 * @example
 * var recorder = RecordRTC(mediaStream or [arrayOfMediaStream], {
 *     type: 'video', // audio or video or gif or canvas
 *     recorderType: MediaStreamRecorder || CanvasRecorder || StereoAudioRecorder || Etc
 * });
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, desiredSampRate: 16000, video: HTMLVideoElement, etc.}
 */function t(f,r){if(!f)throw"First parameter is required.";r=r||{type:"video"},r=new n(f,r);var c=this;function M(P){return r.disableLogs||console.log("RecordRTC version: ",c.version),P&&(r=new n(f,P)),r.disableLogs||console.log("started recording "+r.type+" stream."),B?(B.clearRecordedData(),B.record(),k("recording"),c.recordingDuration&&S(),c):(_(function(){c.recordingDuration&&S()}),c)}function _(P){P&&(r.initCallback=function(){P(),P=r.initCallback=null});var W=new i(f,r);B=new W(f,r),B.record(),k("recording"),r.disableLogs||console.log("Initialized recorderType:",B.constructor.name,"for output-type:",r.type)}function L(P){if(P=P||function(){},!B){I();return}if(c.state==="paused"){c.resumeRecording(),setTimeout(function(){L(P)},1);return}c.state!=="recording"&&!r.disableLogs&&console.warn('Recording state should be: "recording", however current state is: ',c.state),r.disableLogs||console.log("Stopped recording "+r.type+" stream."),r.type!=="gif"?B.stop(W):(B.stop(),W()),k("stopped");function W(K){if(!B){typeof P.call=="function"?P.call(c,""):P("");return}Object.keys(B).forEach(function(G){typeof B[G]!="function"&&(c[G]=B[G])});var T=B.blob;if(!T)if(K)B.blob=T=K;else throw"Recording failed.";if(T&&!r.disableLogs&&console.log(T.type,"->",y(T.size)),P){var j;try{j=p.createObjectURL(T)}catch{}typeof P.call=="function"?P.call(c,j):P(j)}r.autoWriteToDisk&&v(function(G){var H={};H[r.type+"Blob"]=G,Oe.Store(H)})}}function o(){if(!B){I();return}if(c.state!=="recording"){r.disableLogs||console.warn("Unable to pause the recording. Recording state: ",c.state);return}k("paused"),B.pause(),r.disableLogs||console.log("Paused recording.")}function l(){if(!B){I();return}if(c.state!=="paused"){r.disableLogs||console.warn("Unable to resume the recording. Recording state: ",c.state);return}k("recording"),B.resume(),r.disableLogs||console.log("Resumed recording.")}function R(P){postMessage(new FileReaderSync().readAsDataURL(P))}function v(P,W){if(!P)throw"Pass a callback function over getDataURL.";var K=W?W.blob:(B||{}).blob;if(!K){r.disableLogs||console.warn("Blob encoder did not finish its job yet."),setTimeout(function(){v(P,W)},1e3);return}if(typeof Worker<"u"&&!navigator.mozGetUserMedia){var T=G(R);T.onmessage=function(H){P(H.data)},T.postMessage(K)}else{var j=new FileReader;j.readAsDataURL(K),j.onload=function(H){P(H.target.result)}}function G(H){try{var ne=p.createObjectURL(new Blob([H.toString(),"this.onmessage =  function (eee) {"+H.name+"(eee.data);}"],{type:"application/javascript"})),re=new Worker(ne);return p.revokeObjectURL(ne),re}catch{}}}function S(P){if(P=P||0,c.state==="paused"){setTimeout(function(){S(P)},1e3);return}if(c.state!=="stopped"){if(P>=c.recordingDuration){L(c.onRecordingStopped);return}P+=1e3,setTimeout(function(){S(P)},1e3)}}function k(P){c&&(c.state=P,typeof c.onStateChanged.call=="function"?c.onStateChanged.call(c,P):c.onStateChanged(P))}var q='It seems that recorder is destroyed or "startRecording" is not invoked for '+r.type+" recorder.";function I(){r.disableLogs!==!0&&console.warn(q)}var B,V={startRecording:M,stopRecording:L,pauseRecording:o,resumeRecording:l,initRecorder:_,setRecordingDuration:function(P,W){if(typeof P>"u")throw"recordingDuration is required.";if(typeof P!="number")throw"recordingDuration must be a number.";return c.recordingDuration=P,c.onRecordingStopped=W||function(){},{onRecordingStopped:function(K){c.onRecordingStopped=K}}},clearRecordedData:function(){if(!B){I();return}B.clearRecordedData(),r.disableLogs||console.log("Cleared old recorded data.")},getBlob:function(){if(!B){I();return}return B.blob},getDataURL:v,toURL:function(){if(!B){I();return}return p.createObjectURL(B.blob)},getInternalRecorder:function(){return B},save:function(P){if(!B){I();return}D(B.blob,P)},getFromDisk:function(P){if(!B){I();return}t.getFromDisk(r.type,P)},setAdvertisementArray:function(P){r.advertisement=[];for(var W=P.length,K=0;K<W;K++)r.advertisement.push({duration:K,image:P[K]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,reset:function(){c.state==="recording"&&!r.disableLogs&&console.warn("Stop an active recorder."),B&&typeof B.clearRecordedData=="function"&&B.clearRecordedData(),B=null,k("inactive"),c.blob=null},onStateChanged:function(P){r.disableLogs||console.log("Recorder state changed:",P)},state:"inactive",getState:function(){return c.state},destroy:function(){var P=r.disableLogs;r={disableLogs:!0},c.reset(),k("destroyed"),V=c=null,N.AudioContextConstructor&&(N.AudioContextConstructor.close(),N.AudioContextConstructor=null),r.disableLogs=P,r.disableLogs||console.log("RecordRTC is destroyed.")},version:"5.6.2"};if(!this)return c=V,V;for(var ie in V)this[ie]=V[ie];return c=this,V}t.version="5.6.2",e.exports=t,t.getFromDisk=function(f,r){if(!r)throw"callback is mandatory.";console.log("Getting recorded "+(f==="all"?"blobs":f+" blob ")+" from disk!"),Oe.Fetch(function(c,M){f!=="all"&&M===f+"Blob"&&r&&r(c),f==="all"&&r&&r(c,M.replace("Blob",""))})},t.writeToDisk=function(f){console.log("Writing recorded blob(s) to disk!"),f=f||{},f.audio&&f.video&&f.gif?f.audio.getDataURL(function(r){f.video.getDataURL(function(c){f.gif.getDataURL(function(M){Oe.Store({audioBlob:r,videoBlob:c,gifBlob:M})})})}):f.audio&&f.video?f.audio.getDataURL(function(r){f.video.getDataURL(function(c){Oe.Store({audioBlob:r,videoBlob:c})})}):f.audio&&f.gif?f.audio.getDataURL(function(r){f.gif.getDataURL(function(c){Oe.Store({audioBlob:r,gifBlob:c})})}):f.video&&f.gif?f.video.getDataURL(function(r){f.gif.getDataURL(function(c){Oe.Store({videoBlob:r,gifBlob:c})})}):f.audio?f.audio.getDataURL(function(r){Oe.Store({audioBlob:r})}):f.video?f.video.getDataURL(function(r){Oe.Store({videoBlob:r})}):f.gif&&f.gif.getDataURL(function(r){Oe.Store({gifBlob:r})})};/**
 * {@link RecordRTCConfiguration} is an inner/private helper for {@link RecordRTC}.
 * @summary It configures the 2nd parameter passed over {@link RecordRTC} and returns a valid "config" object.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCConfiguration
 * @class
 * @example
 * var options = RecordRTCConfiguration(mediaStream, options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, getNativeBlob:true, etc.}
 */function n(f,r){return!r.recorderType&&!r.type&&(r.audio&&r.video?r.type="video":r.audio&&!r.video&&(r.type="audio")),r.recorderType&&!r.type&&(r.recorderType===ae||r.recorderType===te||typeof st<"u"&&r.recorderType===st?r.type="video":r.recorderType===Xe?r.type="gif":r.recorderType===Y?r.type="audio":r.recorderType===U&&(O(f,"audio").length&&O(f,"video").length||!O(f,"audio").length&&O(f,"video").length?r.type="video":O(f,"audio").length&&!O(f,"video").length&&(r.type="audio"))),typeof U<"u"&&typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&(r.mimeType||(r.mimeType="video/webm"),r.type||(r.type=r.mimeType.split("/")[0]),r.bitsPerSecond),r.type||(r.mimeType&&(r.type=r.mimeType.split("/")[0]),r.type||(r.type="audio")),r}/**
 * {@link GetRecorderType} is an inner/private helper for {@link RecordRTC}.
 * @summary It returns best recorder-type available for your browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GetRecorderType
 * @class
 * @example
 * var RecorderType = GetRecorderType(options);
 * var recorder = new RecorderType(options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 */function i(f,r){var c;return(E||b||$)&&(c=Y),typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&!E&&(c=U),r.type==="video"&&(E||$)&&(c=ae,typeof st<"u"&&typeof ReadableStream<"u"&&(c=st)),r.type==="gif"&&(c=Xe),r.type==="canvas"&&(c=te),x()&&c!==te&&c!==Xe&&typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&(O(f,"video").length||O(f,"audio").length)&&(r.type==="audio"?typeof MediaRecorder.isTypeSupported=="function"&&MediaRecorder.isTypeSupported("audio/webm")&&(c=U):typeof MediaRecorder.isTypeSupported=="function"&&MediaRecorder.isTypeSupported("video/webm")&&(c=U)),f instanceof Array&&f.length&&(c=rt),r.recorderType&&(c=r.recorderType),!r.disableLogs&&c&&c.name&&console.log("Using recorderType:",c.name||c.constructor.name),!c&&g&&(c=U),c}/**
 * MRecordRTC runs on top of {@link RecordRTC} to bring multiple recordings in a single place, by providing simple API.
 * @summary MRecordRTC stands for "Multiple-RecordRTC".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MRecordRTC
 * @class
 * @example
 * var recorder = new MRecordRTC();
 * recorder.addStream(MediaStream);
 * recorder.mediaType = {
 *     audio: true, // or StereoAudioRecorder or MediaStreamRecorder
 *     video: true, // or WhammyRecorder or MediaStreamRecorder or WebAssemblyRecorder or CanvasRecorder
 *     gif: true    // or GifRecorder
 * };
 * // mimeType is optional and should be set only in advance cases.
 * recorder.mimeType = {
 *     audio: 'audio/wav',
 *     video: 'video/webm',
 *     gif:   'image/gif'
 * };
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC/tree/master/MRecordRTC|MRecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @requires {@link RecordRTC}
 */function s(f){this.addStream=function(r){r&&(f=r)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){var r=this.mediaType,c,M=this.mimeType||{audio:null,video:null,gif:null};if(typeof r.audio!="function"&&x()&&!O(f,"audio").length&&(r.audio=!1),typeof r.video!="function"&&x()&&!O(f,"video").length&&(r.video=!1),typeof r.gif!="function"&&x()&&!O(f,"video").length&&(r.gif=!1),!r.audio&&!r.video&&!r.gif)throw"MediaStream must have either audio or video tracks.";if(r.audio&&(c=null,typeof r.audio=="function"&&(c=r.audio),this.audioRecorder=new t(f,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate,numberOfAudioChannels:this.numberOfAudioChannels||2,disableLogs:this.disableLogs,recorderType:c,mimeType:M.audio,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp}),r.video||this.audioRecorder.startRecording()),r.video){c=null,typeof r.video=="function"&&(c=r.video);var _=f;if(x()&&r.audio&&typeof r.audio=="function"){var L=O(f,"video")[0];F?(_=new w,_.addTrack(L),c&&c===ae&&(c=U)):(_=new w,_.addTrack(L))}this.videoRecorder=new t(_,{type:"video",video:this.video,canvas:this.canvas,frameInterval:this.frameInterval||10,disableLogs:this.disableLogs,recorderType:c,mimeType:M.video,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp,workerPath:this.workerPath,webAssemblyPath:this.webAssemblyPath,frameRate:this.frameRate,bitrate:this.bitrate}),r.audio||this.videoRecorder.startRecording()}if(r.audio&&r.video){var o=this,l=x()===!0;(r.audio instanceof Y&&r.video||r.audio!==!0&&r.video!==!0&&r.audio!==r.video)&&(l=!1),l===!0?(o.audioRecorder=null,o.videoRecorder.startRecording()):o.videoRecorder.initRecorder(function(){o.audioRecorder.initRecorder(function(){o.videoRecorder.startRecording(),o.audioRecorder.startRecording()})})}r.gif&&(c=null,typeof r.gif=="function"&&(c=r.gif),this.gifRecorder=new t(f,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10,disableLogs:this.disableLogs,recorderType:c,mimeType:M.gif}),this.gifRecorder.startRecording())},this.stopRecording=function(r){r=r||function(){},this.audioRecorder&&this.audioRecorder.stopRecording(function(c){r(c,"audio")}),this.videoRecorder&&this.videoRecorder.stopRecording(function(c){r(c,"video")}),this.gifRecorder&&this.gifRecorder.stopRecording(function(c){r(c,"gif")})},this.pauseRecording=function(){this.audioRecorder&&this.audioRecorder.pauseRecording(),this.videoRecorder&&this.videoRecorder.pauseRecording(),this.gifRecorder&&this.gifRecorder.pauseRecording()},this.resumeRecording=function(){this.audioRecorder&&this.audioRecorder.resumeRecording(),this.videoRecorder&&this.videoRecorder.resumeRecording(),this.gifRecorder&&this.gifRecorder.resumeRecording()},this.getBlob=function(r){var c={};return this.audioRecorder&&(c.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(c.video=this.videoRecorder.getBlob()),this.gifRecorder&&(c.gif=this.gifRecorder.getBlob()),r&&r(c),c},this.destroy=function(){this.audioRecorder&&(this.audioRecorder.destroy(),this.audioRecorder=null),this.videoRecorder&&(this.videoRecorder.destroy(),this.videoRecorder=null),this.gifRecorder&&(this.gifRecorder.destroy(),this.gifRecorder=null)},this.getDataURL=function(r){this.getBlob(function(_){_.audio&&_.video?c(_.audio,function(L){c(_.video,function(o){r({audio:L,video:o})})}):_.audio?c(_.audio,function(L){r({audio:L})}):_.video&&c(_.video,function(L){r({video:L})})});function c(_,L){if(typeof Worker<"u"){var o=M(function(v){postMessage(new FileReaderSync().readAsDataURL(v))});o.onmessage=function(R){L(R.data)},o.postMessage(_)}else{var l=new FileReader;l.readAsDataURL(_),l.onload=function(R){L(R.target.result)}}}function M(_){var L=p.createObjectURL(new Blob([_.toString(),"this.onmessage =  function (eee) {"+_.name+"(eee.data);}"],{type:"application/javascript"})),o=new Worker(L),l;if(typeof p<"u")l=p;else if(typeof webkitURL<"u")l=webkitURL;else throw"Neither URL nor webkitURL detected.";return l.revokeObjectURL(L),o}},this.writeToDisk=function(){t.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(r){r=r||{audio:!0,video:!0,gif:!0},r.audio&&this.audioRecorder&&this.audioRecorder.save(typeof r.audio=="string"?r.audio:""),r.video&&this.videoRecorder&&this.videoRecorder.save(typeof r.video=="string"?r.video:""),r.gif&&this.gifRecorder&&this.gifRecorder.save(typeof r.gif=="string"?r.gif:"")}}s.getFromDisk=t.getFromDisk,s.writeToDisk=t.writeToDisk,typeof t<"u"&&(t.MRecordRTC=s);var a="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(f){f&&(typeof window<"u"||typeof fe>"u"||(fe.navigator={userAgent:a,getUserMedia:function(){}},fe.console||(fe.console={}),(typeof fe.console.log>"u"||typeof fe.console.error>"u")&&(fe.console.error=fe.console.log=fe.console.log||function(){console.log(arguments)}),typeof document>"u"&&(f.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var r={getContext:function(){return r},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return r},f.HTMLVideoElement=function(){}),typeof location>"u"&&(f.location={protocol:"file:",href:"",hash:""}),typeof screen>"u"&&(f.screen={width:0,height:0}),typeof p>"u"&&(f.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),f.window=fe))})(typeof fe<"u"?fe:null);var u=window.requestAnimationFrame;if(typeof u>"u"){if(typeof webkitRequestAnimationFrame<"u")u=webkitRequestAnimationFrame;else if(typeof mozRequestAnimationFrame<"u")u=mozRequestAnimationFrame;else if(typeof msRequestAnimationFrame<"u")u=msRequestAnimationFrame;else if(typeof u>"u"){var d=0;u=function(f,r){var c=new Date().getTime(),M=Math.max(0,16-(c-d)),_=setTimeout(function(){f(c+M)},M);return d=c+M,_}}}var m=window.cancelAnimationFrame;typeof m>"u"&&(typeof webkitCancelAnimationFrame<"u"?m=webkitCancelAnimationFrame:typeof mozCancelAnimationFrame<"u"?m=mozCancelAnimationFrame:typeof msCancelAnimationFrame<"u"?m=msCancelAnimationFrame:typeof m>"u"&&(m=function(f){clearTimeout(f)}));var C=window.AudioContext;typeof C>"u"&&(typeof webkitAudioContext<"u"&&(C=webkitAudioContext),typeof mozAudioContext<"u"&&(C=mozAudioContext));var p=window.URL;typeof p>"u"&&typeof webkitURL<"u"&&(p=webkitURL),typeof navigator<"u"&&typeof navigator.getUserMedia>"u"&&(typeof navigator.webkitGetUserMedia<"u"&&(navigator.getUserMedia=navigator.webkitGetUserMedia),typeof navigator.mozGetUserMedia<"u"&&(navigator.getUserMedia=navigator.mozGetUserMedia));var b=navigator.userAgent.indexOf("Edge")!==-1&&(!!navigator.msSaveBlob||!!navigator.msSaveOrOpenBlob),$=!!window.opera||navigator.userAgent.indexOf("OPR/")!==-1,F=navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&"netscape"in window&&/ rv:/.test(navigator.userAgent),E=!$&&!b&&!!navigator.webkitGetUserMedia||A()||navigator.userAgent.toLowerCase().indexOf("chrome/")!==-1,g=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);g&&!E&&navigator.userAgent.indexOf("CriOS")!==-1&&(g=!1,E=!0);var w=window.MediaStream;typeof w>"u"&&typeof webkitMediaStream<"u"&&(w=webkitMediaStream),typeof w<"u"&&typeof w.prototype.stop>"u"&&(w.prototype.stop=function(){this.getTracks().forEach(function(f){f.stop()})});function y(f){var r=1e3,c=["Bytes","KB","MB","GB","TB"];if(f===0)return"0 Bytes";var M=parseInt(Math.floor(Math.log(f)/Math.log(r)),10);return(f/Math.pow(r,M)).toPrecision(3)+" "+c[M]}function D(f,r){if(!f)throw"Blob object is required.";if(!f.type)try{f.type="video/webm"}catch{}var c=(f.type||"video/webm").split("/")[1];if(c.indexOf(";")!==-1&&(c=c.split(";")[0]),r&&r.indexOf(".")!==-1){var M=r.split(".");r=M[0],c=M[1]}var _=(r||Math.round(Math.random()*9999999999)+888888888)+"."+c;if(typeof navigator.msSaveOrOpenBlob<"u")return navigator.msSaveOrOpenBlob(f,_);if(typeof navigator.msSaveBlob<"u")return navigator.msSaveBlob(f,_);var L=document.createElement("a");L.href=p.createObjectURL(f),L.download=_,L.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(L),typeof L.click=="function"?L.click():(L.target="_blank",L.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),p.revokeObjectURL(L.href)}function A(){return!!(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0)}function O(f,r){return!f||!f.getTracks?[]:f.getTracks().filter(function(c){return c.kind===(r||"audio")})}function Q(f,r){"srcObject"in r?r.srcObject=f:"mozSrcObject"in r?r.mozSrcObject=f:r.srcObject=f}function z(f,r){if(typeof EBML>"u")throw new Error("Please link: https://www.webrtc-experiment.com/EBML.js");var c=new EBML.Reader,M=new EBML.Decoder,_=EBML.tools,L=new FileReader;L.onload=function(o){var l=M.decode(this.result);l.forEach(function(k){c.read(k)}),c.stop();var R=_.makeMetadataSeekable(c.metadatas,c.duration,c.cues),v=this.result.slice(c.metadataSize),S=new Blob([R,v],{type:"video/webm"});r(S)},L.readAsArrayBuffer(f)}typeof t<"u"&&(t.invokeSaveAsDialog=D,t.getTracks=O,t.getSeekableBlob=z,t.bytesToSize=y,t.isElectron=A);/**
 * Storage is a standalone object used by {@link RecordRTC} to store reusable objects e.g. "new AudioContext".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * Storage.AudioContext === webkitAudioContext
 * @property {webkitAudioContext} AudioContext - Keeps a reference to AudioContext object.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var N={};typeof C<"u"?N.AudioContext=C:typeof webkitAudioContext<"u"&&(N.AudioContext=webkitAudioContext),typeof t<"u"&&(t.Storage=N);function x(){if(F||g||b)return!0;var f=navigator.userAgent,r=""+parseFloat(navigator.appVersion),c=parseInt(navigator.appVersion,10),M,_;return(E||$)&&(M=f.indexOf("Chrome"),r=f.substring(M+7)),(_=r.indexOf(";"))!==-1&&(r=r.substring(0,_)),(_=r.indexOf(" "))!==-1&&(r=r.substring(0,_)),c=parseInt(""+r,10),isNaN(c)&&(r=""+parseFloat(navigator.appVersion),c=parseInt(navigator.appVersion,10)),c>=49}/**
 * MediaStreamRecorder is an abstraction layer for {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}. It is used by {@link RecordRTC} to record MediaStream(s) in both Chrome and Firefox.
 * @summary Runs top over {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://github.com/muaz-khan|Muaz Khan}
 * @typedef MediaStreamRecorder
 * @class
 * @example
 * var config = {
 *     mimeType: 'video/webm', // vp8, vp9, h264, mkv, opus/vorbis
 *     audioBitsPerSecond : 256 * 8 * 1024,
 *     videoBitsPerSecond : 256 * 8 * 1024,
 *     bitsPerSecond: 256 * 8 * 1024,  // if this is provided, skip above two
 *     checkForInactiveTracks: true,
 *     timeSlice: 1000, // concatenate intervals based blobs
 *     ondataavailable: function() {} // get intervals based blobs
 * }
 * var recorder = new MediaStreamRecorder(mediaStream, config);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs:true, initCallback: function, mimeType: "video/webm", timeSlice: 1000}
 * @throws Will throw an error if first argument "MediaStream" is missing. Also throws error if "MediaRecorder API" are not supported by the browser.
 */function U(f,r){var S=this;if(typeof f>"u")throw'First argument "MediaStream" is required.';if(typeof MediaRecorder>"u")throw"Your browser does not support the Media Recorder API. Please try other modules e.g. WhammyRecorder or StereoAudioRecorder.";if(r=r||{mimeType:"video/webm"},r.type==="audio"){if(O(f,"video").length&&O(f,"audio").length){var c;navigator.mozGetUserMedia?(c=new w,c.addTrack(O(f,"audio")[0])):c=new w(O(f,"audio")),f=c}(!r.mimeType||r.mimeType.toString().toLowerCase().indexOf("audio")===-1)&&(r.mimeType=E?"audio/webm":"audio/ogg"),r.mimeType&&r.mimeType.toString().toLowerCase()!=="audio/ogg"&&navigator.mozGetUserMedia&&(r.mimeType="audio/ogg")}var M=[];this.getArrayOfBlobs=function(){return M},this.record=function(){S.blob=null,S.clearRecordedData(),S.timestamps=[],v=[],M=[];var k=r;r.disableLogs||console.log("Passing following config over MediaRecorder API.",k),l&&(l=null),E&&!x()&&(k="video/vp8"),typeof MediaRecorder.isTypeSupported=="function"&&k.mimeType&&(MediaRecorder.isTypeSupported(k.mimeType)||(r.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",k.mimeType),k.mimeType=r.type==="audio"?"audio/webm":"video/webm"));try{l=new MediaRecorder(f,k),r.mimeType=k.mimeType}catch{l=new MediaRecorder(f)}k.mimeType&&!MediaRecorder.isTypeSupported&&"canRecordMimeType"in l&&l.canRecordMimeType(k.mimeType)===!1&&(r.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",k.mimeType)),l.ondataavailable=function(q){if(q.data&&v.push("ondataavailable: "+y(q.data.size)),typeof r.timeSlice=="number"){if(q.data&&q.data.size&&(M.push(q.data),_(),typeof r.ondataavailable=="function")){var I=r.getNativeBlob?q.data:new Blob([q.data],{type:L(k)});r.ondataavailable(I)}return}if(!q.data||!q.data.size||q.data.size<100||S.blob){S.recordingCallback&&(S.recordingCallback(new Blob([],{type:L(k)})),S.recordingCallback=null);return}S.blob=r.getNativeBlob?q.data:new Blob([q.data],{type:L(k)}),S.recordingCallback&&(S.recordingCallback(S.blob),S.recordingCallback=null)},l.onstart=function(){v.push("started")},l.onpause=function(){v.push("paused")},l.onresume=function(){v.push("resumed")},l.onstop=function(){v.push("stopped")},l.onerror=function(q){q&&(q.name||(q.name="UnknownError"),v.push("error: "+q),r.disableLogs||(q.name.toString().toLowerCase().indexOf("invalidstate")!==-1?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.",q):q.name.toString().toLowerCase().indexOf("notsupported")!==-1?console.error("MIME type (",k.mimeType,") is not supported.",q):q.name.toString().toLowerCase().indexOf("security")!==-1?console.error("MediaRecorder security error",q):q.name==="OutOfMemory"?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.",q):q.name==="IllegalStreamModification"?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.",q):q.name==="OtherRecordingError"?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.",q):q.name==="GenericError"?console.error("The UA cannot provide the codec or recording option that has been requested.",q):console.error("MediaRecorder Error",q)),function(I){if(!S.manuallyStopped&&l&&l.state==="inactive"){delete r.timeslice,l.start(10*60*1e3);return}setTimeout(I,1e3)}(),l.state!=="inactive"&&l.state!=="stopped"&&l.stop())},typeof r.timeSlice=="number"?(_(),l.start(r.timeSlice)):l.start(36e5),r.initCallback&&r.initCallback()},this.timestamps=[];function _(){S.timestamps.push(new Date().getTime()),typeof r.onTimeStamp=="function"&&r.onTimeStamp(S.timestamps[S.timestamps.length-1],S.timestamps)}function L(k){return l&&l.mimeType?l.mimeType:k.mimeType||"video/webm"}this.stop=function(k){k=k||function(){},S.manuallyStopped=!0,l&&(this.recordingCallback=k,l.state==="recording"&&l.stop(),typeof r.timeSlice=="number"&&setTimeout(function(){S.blob=new Blob(M,{type:L(r)}),S.recordingCallback(S.blob)},100))},this.pause=function(){l&&l.state==="recording"&&l.pause()},this.resume=function(){l&&l.state==="paused"&&l.resume()},this.clearRecordedData=function(){l&&l.state==="recording"&&S.stop(o),o()};function o(){M=[],l=null,S.timestamps=[]}var l;this.getInternalRecorder=function(){return l};function R(){if("active"in f){if(!f.active)return!1}else if("ended"in f&&f.ended)return!1;return!0}this.blob=null,this.getState=function(){return l&&l.state||"inactive"};var v=[];this.getAllStates=function(){return v},typeof r.checkForInactiveTracks>"u"&&(r.checkForInactiveTracks=!1);var S=this;(function k(){if(!(!l||r.checkForInactiveTracks===!1)){if(R()===!1){r.disableLogs||console.log("MediaStream seems stopped."),S.stop();return}setTimeout(k,1e3)}})(),this.name="MediaStreamRecorder",this.toString=function(){return this.name}}typeof t<"u"&&(t.MediaStreamRecorder=U);/**
 * StereoAudioRecorder is a standalone class used by {@link RecordRTC} to bring "stereo" audio-recording in chrome.
 * @summary JavaScript standalone object for stereo audio recording.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef StereoAudioRecorder
 * @class
 * @example
 * var recorder = new StereoAudioRecorder(MediaStream, {
 *     sampleRate: 44100,
 *     bufferSize: 4096
 * });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {sampleRate: 44100, bufferSize: 4096, numberOfAudioChannels: 1, etc.}
 */function Y(f,r){if(!O(f,"audio").length)throw"Your stream has no audio tracks.";r=r||{};var c=this,M=[],_=[],L=!1,o=0,l,R=2,v=r.desiredSampRate;r.leftChannel===!0&&(R=1),r.numberOfAudioChannels===1&&(R=1),(!R||R<1)&&(R=2),r.disableLogs||console.log("StereoAudioRecorder is set to record number of channels: "+R),typeof r.checkForInactiveTracks>"u"&&(r.checkForInactiveTracks=!0);function S(){if(r.checkForInactiveTracks===!1)return!0;if("active"in f){if(!f.active)return!1}else if("ended"in f&&f.ended)return!1;return!0}this.record=function(){if(S()===!1)throw"Please make sure MediaStream is active.";K(),j=W=!1,L=!0,typeof r.timeSlice<"u"&&ne()};function k(re,ve){function me(be,pn){var Ve=be.numberOfAudioChannels,$e=be.leftBuffers.slice(0),at=be.rightBuffers.slice(0),xe=be.sampleRate,lt=be.internalInterleavedLength,Ke=be.desiredSampRate;Ve===2&&($e=ti($e,lt),at=ti(at,lt),Ke&&($e=gn($e,Ke,xe),at=gn(at,Ke,xe))),Ve===1&&($e=ti($e,lt),Ke&&($e=gn($e,Ke,xe))),Ke&&(xe=Ke);function gn(we,Ze,Ue){var qe=Math.round(we.length*(Ze/Ue)),Me=[],ut=Number((we.length-1)/(qe-1));Me[0]=we[0];for(var Dt=1;Dt<qe-1;Dt++){var ri=Dt*ut,Yi=Number(Math.floor(ri)).toFixed(),ws=Number(Math.ceil(ri)).toFixed(),Ss=ri-Yi;Me[Dt]=gs(we[Yi],we[ws],Ss)}return Me[qe-1]=we[we.length-1],Me}function gs(we,Ze,Ue){return we+(Ze-we)*Ue}function ti(we,Ze){for(var Ue=new Float64Array(Ze),qe=0,Me=we.length,ut=0;ut<Me;ut++){var Dt=we[ut];Ue.set(Dt,qe),qe+=Dt.length}return Ue}function ys(we,Ze){for(var Ue=we.length+Ze.length,qe=new Float64Array(Ue),Me=0,ut=0;ut<Ue;)qe[ut++]=we[Me],qe[ut++]=Ze[Me],Me++;return qe}function In(we,Ze,Ue){for(var qe=Ue.length,Me=0;Me<qe;Me++)we.setUint8(Ze+Me,Ue.charCodeAt(Me))}var $n;Ve===2&&($n=ys($e,at)),Ve===1&&($n=$e);var Fn=$n.length,vs=44+Fn*2,ni=new ArrayBuffer(vs),Ce=new DataView(ni);In(Ce,0,"RIFF"),Ce.setUint32(4,36+Fn*2,!0),In(Ce,8,"WAVE"),In(Ce,12,"fmt "),Ce.setUint32(16,16,!0),Ce.setUint16(20,1,!0),Ce.setUint16(22,Ve,!0),Ce.setUint32(24,xe,!0),Ce.setUint32(28,xe*Ve*2,!0),Ce.setUint16(32,Ve*2,!0),Ce.setUint16(34,16,!0),In(Ce,36,"data"),Ce.setUint32(40,Fn*2,!0);for(var ms=Fn,Ji=44,bs=1,ii=0;ii<ms;ii++)Ce.setInt16(Ji,$n[ii]*(32767*bs),!0),Ji+=2;if(pn)return pn({buffer:ni,view:Ce});postMessage({buffer:ni,view:Ce})}if(re.noWorker){me(re,function(be){ve(be.buffer,be.view)});return}var ot=q(me);ot.onmessage=function(be){ve(be.data.buffer,be.data.view),p.revokeObjectURL(ot.workerURL),ot.terminate()},ot.postMessage(re)}function q(re){var ve=p.createObjectURL(new Blob([re.toString(),";this.onmessage =  function (eee) {"+re.name+"(eee.data);}"],{type:"application/javascript"})),me=new Worker(ve);return me.workerURL=ve,me}this.stop=function(re){re=re||function(){},L=!1,k({desiredSampRate:v,sampleRate:P,numberOfAudioChannels:R,internalInterleavedLength:o,leftBuffers:M,rightBuffers:R===1?[]:_,noWorker:r.noWorker},function(ve,me){c.blob=new Blob([me],{type:"audio/wav"}),c.buffer=new ArrayBuffer(me.buffer.byteLength),c.view=me,c.sampleRate=v||P,c.bufferSize=ie,c.length=o,j=!1,re&&re(c.blob)})},typeof t.Storage>"u"&&(t.Storage={AudioContextConstructor:null,AudioContext:window.AudioContext||window.webkitAudioContext}),(!t.Storage.AudioContextConstructor||t.Storage.AudioContextConstructor.state==="closed")&&(t.Storage.AudioContextConstructor=new t.Storage.AudioContext);var I=t.Storage.AudioContextConstructor,B=I.createMediaStreamSource(f),V=[0,256,512,1024,2048,4096,8192,16384],ie=typeof r.bufferSize>"u"?4096:r.bufferSize;if(V.indexOf(ie)===-1&&(r.disableLogs||console.log("Legal values for buffer-size are "+JSON.stringify(V,null,"	"))),I.createJavaScriptNode)l=I.createJavaScriptNode(ie,R,R);else if(I.createScriptProcessor)l=I.createScriptProcessor(ie,R,R);else throw"WebAudio API has no support on this browser.";B.connect(l),r.bufferSize||(ie=l.bufferSize);var P=typeof r.sampleRate<"u"?r.sampleRate:I.sampleRate||44100;(P<22050||P>96e3)&&(r.disableLogs||console.log("sample-rate must be under range 22050 and 96000.")),r.disableLogs||r.desiredSampRate&&console.log("Desired sample-rate: "+r.desiredSampRate);var W=!1;this.pause=function(){W=!0},this.resume=function(){if(S()===!1)throw"Please make sure MediaStream is active.";if(!L){r.disableLogs||console.log("Seems recording has been restarted."),this.record();return}W=!1},this.clearRecordedData=function(){r.checkForInactiveTracks=!1,L&&this.stop(T),T()};function K(){M=[],_=[],o=0,j=!1,L=!1,W=!1,I=null,c.leftchannel=M,c.rightchannel=_,c.numberOfAudioChannels=R,c.desiredSampRate=v,c.sampleRate=P,c.recordingLength=o,H={left:[],right:[],recordingLength:0}}function T(){l&&(l.onaudioprocess=null,l.disconnect(),l=null),B&&(B.disconnect(),B=null),K()}this.name="StereoAudioRecorder",this.toString=function(){return this.name};var j=!1;function G(re){if(!W){if(S()===!1&&(r.disableLogs||console.log("MediaStream seems stopped."),l.disconnect(),L=!1),!L){B&&(B.disconnect(),B=null);return}j||(j=!0,r.onAudioProcessStarted&&r.onAudioProcessStarted(),r.initCallback&&r.initCallback());var ve=re.inputBuffer.getChannelData(0),me=new Float32Array(ve);if(M.push(me),R===2){var ot=re.inputBuffer.getChannelData(1),be=new Float32Array(ot);_.push(be)}o+=ie,c.recordingLength=o,typeof r.timeSlice<"u"&&(H.recordingLength+=ie,H.left.push(me),R===2&&H.right.push(be))}}l.onaudioprocess=G,I.createMediaStreamDestination?l.connect(I.createMediaStreamDestination()):l.connect(I.destination),this.leftchannel=M,this.rightchannel=_,this.numberOfAudioChannels=R,this.desiredSampRate=v,this.sampleRate=P,c.recordingLength=o;var H={left:[],right:[],recordingLength:0};function ne(){!L||typeof r.ondataavailable!="function"||typeof r.timeSlice>"u"||(H.left.length?(k({desiredSampRate:v,sampleRate:P,numberOfAudioChannels:R,internalInterleavedLength:H.recordingLength,leftBuffers:H.left,rightBuffers:R===1?[]:H.right},function(re,ve){var me=new Blob([ve],{type:"audio/wav"});r.ondataavailable(me),setTimeout(ne,r.timeSlice)}),H={left:[],right:[],recordingLength:0}):setTimeout(ne,r.timeSlice))}}typeof t<"u"&&(t.StereoAudioRecorder=Y);/**
 * CanvasRecorder is a standalone class used by {@link RecordRTC} to bring HTML5-Canvas recording into video WebM. It uses HTML2Canvas library and runs top over {@link Whammy}.
 * @summary HTML2Canvas recording into video WebM.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef CanvasRecorder
 * @class
 * @example
 * var recorder = new CanvasRecorder(htmlElement, { disableLogs: true, useWhammyRecorder: true });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {HTMLElement} htmlElement - querySelector/getElementById/getElementsByTagName[0]/etc.
 * @param {object} config - {disableLogs:true, initCallback: function}
 */function te(f,r){if(typeof html2canvas>"u")throw"Please link: https://www.webrtc-experiment.com/screenshot.js";r=r||{},r.frameInterval||(r.frameInterval=10);var c=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(V){V in document.createElement("canvas")&&(c=!0)});var M=(!!window.webkitRTCPeerConnection||!!window.webkitGetUserMedia)&&!!window.chrome,_=50,L=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);M&&L&&L[2]&&(_=parseInt(L[2],10)),M&&_<52&&(c=!1),r.useWhammyRecorder&&(c=!1);var o,l;if(c)if(r.disableLogs||console.log("Your browser supports both MediRecorder API and canvas.captureStream!"),f instanceof HTMLCanvasElement)o=f;else if(f instanceof CanvasRenderingContext2D)o=f.canvas;else throw"Please pass either HTMLCanvasElement or CanvasRenderingContext2D.";else navigator.mozGetUserMedia&&(r.disableLogs||console.error("Canvas recording is NOT supported in Firefox."));var R;this.record=function(){if(R=!0,c&&!r.useWhammyRecorder){var V;"captureStream"in o?V=o.captureStream(25):"mozCaptureStream"in o?V=o.mozCaptureStream(25):"webkitCaptureStream"in o&&(V=o.webkitCaptureStream(25));try{var ie=new w;ie.addTrack(O(V,"video")[0]),V=ie}catch{}if(!V)throw"captureStream API are NOT available.";l=new U(V,{mimeType:r.mimeType||"video/webm"}),l.record()}else B.frames=[],I=new Date().getTime(),q();r.initCallback&&r.initCallback()},this.getWebPImages=function(V){if(f.nodeName.toLowerCase()!=="canvas"){V();return}var ie=B.frames.length;B.frames.forEach(function(P,W){var K=ie-W;r.disableLogs||console.log(K+"/"+ie+" frames remaining"),r.onEncodingCallback&&r.onEncodingCallback(K,ie);var T=P.image.toDataURL("image/webp",1);B.frames[W].image=T}),r.disableLogs||console.log("Generating WebM"),V()},this.stop=function(V){R=!1;var ie=this;if(c&&l){l.stop(V);return}this.getWebPImages(function(){B.compile(function(P){r.disableLogs||console.log("Recording finished!"),ie.blob=P,ie.blob.forEach&&(ie.blob=new Blob([],{type:"video/webm"})),V&&V(ie.blob),B.frames=[]})})};var v=!1;this.pause=function(){if(v=!0,l instanceof U){l.pause();return}},this.resume=function(){if(v=!1,l instanceof U){l.resume();return}R||this.record()},this.clearRecordedData=function(){R&&this.stop(S),S()};function S(){B.frames=[],R=!1,v=!1}this.name="CanvasRecorder",this.toString=function(){return this.name};function k(){var V=document.createElement("canvas"),ie=V.getContext("2d");return V.width=f.width,V.height=f.height,ie.drawImage(f,0,0),V}function q(){if(v)return I=new Date().getTime(),setTimeout(q,500);if(f.nodeName.toLowerCase()==="canvas"){var V=new Date().getTime()-I;I=new Date().getTime(),B.frames.push({image:k(),duration:V}),R&&setTimeout(q,r.frameInterval);return}html2canvas(f,{grabMouse:typeof r.showMousePointer>"u"||r.showMousePointer,onrendered:function(ie){var P=new Date().getTime()-I;if(!P)return setTimeout(q,r.frameInterval);I=new Date().getTime(),B.frames.push({image:ie.toDataURL("image/webp",1),duration:P}),R&&setTimeout(q,r.frameInterval)}})}var I=new Date().getTime(),B=new ze.Video(100)}typeof t<"u"&&(t.CanvasRecorder=te);/**
 * WhammyRecorder is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It runs top over {@link Whammy}.
 * @summary Video recording feature in Chrome.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WhammyRecorder
 * @class
 * @example
 * var recorder = new WhammyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs: true, initCallback: function, video: HTMLVideoElement, etc.}
 */function ae(f,r){r=r||{},r.frameInterval||(r.frameInterval=10),r.disableLogs||console.log("Using frames-interval:",r.frameInterval),this.record=function(){r.width||(r.width=320),r.height||(r.height=240),r.video||(r.video={width:r.width,height:r.height}),r.canvas||(r.canvas={width:r.width,height:r.height}),R.width=r.canvas.width||320,R.height=r.canvas.height||240,v=R.getContext("2d"),r.video&&r.video instanceof HTMLVideoElement?(S=r.video.cloneNode(),r.initCallback&&r.initCallback()):(S=document.createElement("video"),Q(f,S),S.onloadedmetadata=function(){r.initCallback&&r.initCallback()},S.width=r.video.width,S.height=r.video.height),S.muted=!0,S.play(),k=new Date().getTime(),q=new ze.Video,r.disableLogs||(console.log("canvas resolutions",R.width,"*",R.height),console.log("video width/height",S.width||R.width,"*",S.height||R.height)),c(r.frameInterval)};function c(I){I=typeof I<"u"?I:10;var B=new Date().getTime()-k;if(!B)return setTimeout(c,I,I);if(o)return k=new Date().getTime(),setTimeout(c,100);k=new Date().getTime(),S.paused&&S.play(),v.drawImage(S,0,0,R.width,R.height),q.frames.push({duration:B,image:R.toDataURL("image/webp")}),L||setTimeout(c,I,I)}function M(I){var B=-1,V=I.length;(function ie(){if(B++,B===V){I.callback();return}setTimeout(function(){I.functionToLoop(ie,B)},1)})()}function _(I,B,V,ie,P){var W=document.createElement("canvas");W.width=R.width,W.height=R.height;var K=W.getContext("2d"),T=[],j=I.length,G={r:0,g:0,b:0},H=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),ne=0,re=0,ve=!1;M({length:j,functionToLoop:function(me,ot){var be,pn,Ve,$e=function(){!ve&&Ve-be<=Ve*re||(ve=!0,T.push(I[ot])),me()};if(ve)$e();else{var at=new Image;at.onload=function(){K.drawImage(at,0,0,R.width,R.height);var xe=K.getImageData(0,0,R.width,R.height);be=0,pn=xe.data.length,Ve=xe.data.length/4;for(var lt=0;lt<pn;lt+=4){var Ke={r:xe.data[lt],g:xe.data[lt+1],b:xe.data[lt+2]},gn=Math.sqrt(Math.pow(Ke.r-G.r,2)+Math.pow(Ke.g-G.g,2)+Math.pow(Ke.b-G.b,2));gn<=H*ne&&be++}$e()},at.src=I[ot].image}},callback:function(){T=T.concat(I.slice(j)),T.length<=0&&T.push(I[I.length-1]),P(T)}})}var L=!1;this.stop=function(I){I=I||function(){},L=!0;var B=this;setTimeout(function(){_(q.frames,-1,null,null,function(V){q.frames=V,r.advertisement&&r.advertisement.length&&(q.frames=r.advertisement.concat(q.frames)),q.compile(function(ie){B.blob=ie,B.blob.forEach&&(B.blob=new Blob([],{type:"video/webm"})),I&&I(B.blob)})})},10)};var o=!1;this.pause=function(){o=!0},this.resume=function(){o=!1,L&&this.record()},this.clearRecordedData=function(){L||this.stop(l),l()};function l(){q.frames=[],L=!0,o=!1}this.name="WhammyRecorder",this.toString=function(){return this.name};var R=document.createElement("canvas"),v=R.getContext("2d"),S,k,q}typeof t<"u"&&(t.WhammyRecorder=ae);/**
 * Whammy is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It is written by {@link https://github.com/antimatter15|antimatter15}
 * @summary A real time javascript webm encoder based on a canvas hack.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef Whammy
 * @class
 * @example
 * var recorder = new Whammy().Video(15);
 * recorder.add(context || canvas || dataURL);
 * var output = recorder.compile();
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var ze=function(){function f(M){this.frames=[],this.duration=M||1,this.quality=.8}f.prototype.add=function(M,_){if("canvas"in M&&(M=M.canvas),"toDataURL"in M&&(M=M.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/ig.test(M))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:M,duration:_||this.duration})};function r(M){var _=p.createObjectURL(new Blob([M.toString(),"this.onmessage =  function (eee) {"+M.name+"(eee.data);}"],{type:"application/javascript"})),L=new Worker(_);return p.revokeObjectURL(_),L}function c(M){function _(P){var W=o(P);if(!W)return[];for(var K=3e4,T=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:V(W.duration),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:W.width,id:176},{data:W.height,id:186}]}]}]}]}],j=0,G=0;j<P.length;){var H=[],ne=0;do H.push(P[j]),ne+=P[j].duration,j++;while(j<P.length&&ne<K);var re=0,ve={id:524531317,data:L(G,re,H)};T[1].data.push(ve),G+=ne}return S(T)}function L(P,W,K){return[{data:P,id:231}].concat(K.map(function(T){var j=k({discardable:0,frame:T.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(W)});return W+=T.duration,{data:j,id:163}}))}function o(P){if(!P[0]){postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."});return}for(var W=P[0].width,K=P[0].height,T=P[0].duration,j=1;j<P.length;j++)T+=P[j].duration;return{duration:T,width:W,height:K}}function l(P){for(var W=[];P>0;)W.push(P&255),P=P>>8;return new Uint8Array(W.reverse())}function R(P){return new Uint8Array(P.split("").map(function(W){return W.charCodeAt(0)}))}function v(P){var W=[],K=P.length%8?new Array(9-P.length%8).join("0"):"";P=K+P;for(var T=0;T<P.length;T+=8)W.push(parseInt(P.substr(T,8),2));return new Uint8Array(W)}function S(P){for(var W=[],K=0;K<P.length;K++){var T=P[K].data;typeof T=="object"&&(T=S(T)),typeof T=="number"&&(T=v(T.toString(2))),typeof T=="string"&&(T=R(T));var j=T.size||T.byteLength||T.length,G=Math.ceil(Math.ceil(Math.log(j)/Math.log(2))/8),H=j.toString(2),ne=new Array(G*7+7+1-H.length).join("0")+H,re=new Array(G).join("0")+"1"+ne;W.push(l(P[K].id)),W.push(v(re)),W.push(T)}return new Blob(W,{type:"video/webm"})}function k(P){var W=0;if(W|=128,P.trackNum>127)throw"TrackNumber > 127 not supported";var K=[P.trackNum|128,P.timecode>>8,P.timecode&255,W].map(function(T){return String.fromCharCode(T)}).join("")+P.frame;return K}function q(P){for(var W=P.RIFF[0].WEBP[0],K=W.indexOf("*"),T=0,j=[];T<4;T++)j[T]=W.charCodeAt(K+3+T);var G,H,ne;return ne=j[1]<<8|j[0],G=ne&16383,ne=j[3]<<8|j[2],H=ne&16383,{width:G,height:H,data:W,riff:P}}function I(P,W){return parseInt(P.substr(W+4,4).split("").map(function(K){var T=K.charCodeAt(0).toString(2);return new Array(8-T.length+1).join("0")+T}).join(""),2)}function B(P){for(var W=0,K={};W<P.length;){var T=P.substr(W,4),j=I(P,W),G=P.substr(W+4+4,j);W+=8+j,K[T]=K[T]||[],T==="RIFF"||T==="LIST"?K[T].push(B(G)):K[T].push(G)}return K}function V(P){return[].slice.call(new Uint8Array(new Float64Array([P]).buffer),0).map(function(W){return String.fromCharCode(W)}).reverse().join("")}var ie=new _(M.map(function(P){var W=q(B(atob(P.image.slice(23))));return W.duration=P.duration,W}));postMessage(ie)}return f.prototype.compile=function(M){var _=r(c);_.onmessage=function(L){if(L.data.error){console.error(L.data.error);return}M(L.data)},_.postMessage(this.frames)},{Video:f}}();typeof t<"u"&&(t.Whammy=ze);/**
 * DiskStorage is a standalone object used by {@link RecordRTC} to store recorded blobs in IndexedDB storage.
 * @summary Writing blobs into IndexedDB.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * DiskStorage.Store({
 *     audioBlob: yourAudioBlob,
 *     videoBlob: yourVideoBlob,
 *     gifBlob  : yourGifBlob
 * });
 * DiskStorage.Fetch(function(dataURL, type) {
 *     if(type === 'audioBlob') { }
 *     if(type === 'videoBlob') { }
 *     if(type === 'gifBlob')   { }
 * });
 * // DiskStorage.dataStoreName = 'recordRTC';
 * // DiskStorage.onError = function(error) { };
 * @property {function} init - This method must be called once to initialize IndexedDB ObjectStore. Though, it is auto-used internally.
 * @property {function} Fetch - This method fetches stored blobs from IndexedDB.
 * @property {function} Store - This method stores blobs in IndexedDB.
 * @property {function} onError - This function is invoked for any known/unknown error.
 * @property {string} dataStoreName - Name of the ObjectStore created in IndexedDB storage.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var Oe={init:function(){var f=this;if(typeof indexedDB>"u"||typeof indexedDB.open>"u"){console.error("IndexedDB API are not available in this browser.");return}var r=1,c=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),M,_=indexedDB.open(c,r);function L(l){l.createObjectStore(f.dataStoreName)}function o(){var l=M.transaction([f.dataStoreName],"readwrite");f.videoBlob&&l.objectStore(f.dataStoreName).put(f.videoBlob,"videoBlob"),f.gifBlob&&l.objectStore(f.dataStoreName).put(f.gifBlob,"gifBlob"),f.audioBlob&&l.objectStore(f.dataStoreName).put(f.audioBlob,"audioBlob");function R(v){l.objectStore(f.dataStoreName).get(v).onsuccess=function(S){f.callback&&f.callback(S.target.result,v)}}R("audioBlob"),R("videoBlob"),R("gifBlob")}_.onerror=f.onError,_.onsuccess=function(){if(M=_.result,M.onerror=f.onError,M.setVersion)if(M.version!==r){var l=M.setVersion(r);l.onsuccess=function(){L(M),o()}}else o();else o()},_.onupgradeneeded=function(l){L(l.target.result)}},Fetch:function(f){return this.callback=f,this.init(),this},Store:function(f){return this.audioBlob=f.audioBlob,this.videoBlob=f.videoBlob,this.gifBlob=f.gifBlob,this.init(),this},onError:function(f){console.error(JSON.stringify(f,null,"	"))},dataStoreName:"recordRTC",dbName:null};typeof t<"u"&&(t.DiskStorage=Oe);/**
 * GifRecorder is standalone calss used by {@link RecordRTC} to record video or canvas into animated gif.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GifRecorder
 * @class
 * @example
 * var recorder = new GifRecorder(mediaStream || canvas || context, { onGifPreview: function, onGifRecordingStarted: function, width: 1280, height: 720, frameRate: 200, quality: 10 });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     img.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object or HTMLCanvasElement or CanvasRenderingContext2D.
 * @param {object} config - {disableLogs:true, initCallback: function, width: 320, height: 240, frameRate: 200, quality: 10}
 */function Xe(f,r){if(typeof GIFEncoder>"u"){var c=document.createElement("script");c.src="https://www.webrtc-experiment.com/gif-recorder.js",(document.body||document.documentElement).appendChild(c)}r=r||{};var M=f instanceof CanvasRenderingContext2D||f instanceof HTMLCanvasElement;this.record=function(){if(typeof GIFEncoder>"u"){setTimeout(I.record,1e3);return}if(!R){setTimeout(I.record,1e3);return}M||(r.width||(r.width=v.offsetWidth||320),r.height||(r.height=v.offsetHeight||240),r.video||(r.video={width:r.width,height:r.height}),r.canvas||(r.canvas={width:r.width,height:r.height}),o.width=r.canvas.width||320,o.height=r.canvas.height||240,v.width=r.video.width||320,v.height=r.video.height||240),q=new GIFEncoder,q.setRepeat(0),q.setDelay(r.frameRate||200),q.setQuality(r.quality||10),q.start(),typeof r.onGifRecordingStarted=="function"&&r.onGifRecordingStarted();function B(V){if(I.clearedRecordedData!==!0){if(_)return setTimeout(function(){B(V)},100);S=u(B),typeof k===void 0&&(k=V),!(V-k<90)&&(!M&&v.paused&&v.play(),M||l.drawImage(v,0,0,o.width,o.height),r.onGifPreview&&r.onGifPreview(o.toDataURL("image/png")),q.addFrame(l),k=V)}}S=u(B),r.initCallback&&r.initCallback()},this.stop=function(B){B=B||function(){},S&&m(S),this.blob=new Blob([new Uint8Array(q.stream().bin)],{type:"image/gif"}),B(this.blob),q.stream().bin=[]};var _=!1;this.pause=function(){_=!0},this.resume=function(){_=!1},this.clearRecordedData=function(){I.clearedRecordedData=!0,L()};function L(){q&&(q.stream().bin=[])}this.name="GifRecorder",this.toString=function(){return this.name};var o=document.createElement("canvas"),l=o.getContext("2d");M&&(f instanceof CanvasRenderingContext2D?(l=f,o=l.canvas):f instanceof HTMLCanvasElement&&(l=f.getContext("2d"),o=f));var R=!0;if(!M){var v=document.createElement("video");v.muted=!0,v.autoplay=!0,v.playsInline=!0,R=!1,v.onloadedmetadata=function(){R=!0},Q(f,v),v.play()}var S=null,k,q,I=this}typeof t<"u"&&(t.GifRecorder=Xe);function Re(f,r){var c="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(T){typeof t<"u"||T&&(typeof window<"u"||typeof fe>"u"||(fe.navigator={userAgent:c,getUserMedia:function(){}},fe.console||(fe.console={}),(typeof fe.console.log>"u"||typeof fe.console.error>"u")&&(fe.console.error=fe.console.log=fe.console.log||function(){console.log(arguments)}),typeof document>"u"&&(T.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var j={getContext:function(){return j},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return j},T.HTMLVideoElement=function(){}),typeof location>"u"&&(T.location={protocol:"file:",href:"",hash:""}),typeof screen>"u"&&(T.screen={width:0,height:0}),typeof v>"u"&&(T.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),T.window=fe))})(typeof fe<"u"?fe:null),r=r||"multi-streams-mixer";var M=[],_=!1,L=document.createElement("canvas"),o=L.getContext("2d");L.style.opacity=0,L.style.position="absolute",L.style.zIndex=-1,L.style.top="-1000em",L.style.left="-1000em",L.className=r,(document.body||document.documentElement).appendChild(L),this.disableLogs=!1,this.frameInterval=10,this.width=360,this.height=240,this.useGainNode=!0;var l=this,R=window.AudioContext;typeof R>"u"&&(typeof webkitAudioContext<"u"&&(R=webkitAudioContext),typeof mozAudioContext<"u"&&(R=mozAudioContext));var v=window.URL;typeof v>"u"&&typeof webkitURL<"u"&&(v=webkitURL),typeof navigator<"u"&&typeof navigator.getUserMedia>"u"&&(typeof navigator.webkitGetUserMedia<"u"&&(navigator.getUserMedia=navigator.webkitGetUserMedia),typeof navigator.mozGetUserMedia<"u"&&(navigator.getUserMedia=navigator.mozGetUserMedia));var S=window.MediaStream;typeof S>"u"&&typeof webkitMediaStream<"u"&&(S=webkitMediaStream),typeof S<"u"&&typeof S.prototype.stop>"u"&&(S.prototype.stop=function(){this.getTracks().forEach(function(T){T.stop()})});var k={};typeof R<"u"?k.AudioContext=R:typeof webkitAudioContext<"u"&&(k.AudioContext=webkitAudioContext);function q(T,j){"srcObject"in j?j.srcObject=T:"mozSrcObject"in j?j.mozSrcObject=T:j.srcObject=T}this.startDrawingFrames=function(){I()};function I(){if(!_){var T=M.length,j=!1,G=[];if(M.forEach(function(ne){ne.stream||(ne.stream={}),ne.stream.fullcanvas?j=ne:G.push(ne)}),j)L.width=j.stream.width,L.height=j.stream.height;else if(G.length){L.width=T>1?G[0].width*2:G[0].width;var H=1;(T===3||T===4)&&(H=2),(T===5||T===6)&&(H=3),(T===7||T===8)&&(H=4),(T===9||T===10)&&(H=5),L.height=G[0].height*H}else L.width=l.width||360,L.height=l.height||240;j&&j instanceof HTMLVideoElement&&B(j),G.forEach(function(ne,re){B(ne,re)}),setTimeout(I,l.frameInterval)}}function B(T,j){if(!_){var G=0,H=0,ne=T.width,re=T.height;j===1&&(G=T.width),j===2&&(H=T.height),j===3&&(G=T.width,H=T.height),j===4&&(H=T.height*2),j===5&&(G=T.width,H=T.height*2),j===6&&(H=T.height*3),j===7&&(G=T.width,H=T.height*3),typeof T.stream.left<"u"&&(G=T.stream.left),typeof T.stream.top<"u"&&(H=T.stream.top),typeof T.stream.width<"u"&&(ne=T.stream.width),typeof T.stream.height<"u"&&(re=T.stream.height),o.drawImage(T,G,H,ne,re),typeof T.stream.onRender=="function"&&T.stream.onRender(o,G,H,ne,re,j)}}function V(){_=!1;var T=ie(),j=P();return j&&j.getTracks().filter(function(G){return G.kind==="audio"}).forEach(function(G){T.addTrack(G)}),f.forEach(function(G){G.fullcanvas}),T}function ie(){K();var T;"captureStream"in L?T=L.captureStream():"mozCaptureStream"in L?T=L.mozCaptureStream():l.disableLogs||console.error("Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features");var j=new S;return T.getTracks().filter(function(G){return G.kind==="video"}).forEach(function(G){j.addTrack(G)}),L.stream=j,j}function P(){k.AudioContextConstructor||(k.AudioContextConstructor=new k.AudioContext),l.audioContext=k.AudioContextConstructor,l.audioSources=[],l.useGainNode===!0&&(l.gainNode=l.audioContext.createGain(),l.gainNode.connect(l.audioContext.destination),l.gainNode.gain.value=0);var T=0;if(f.forEach(function(j){if(j.getTracks().filter(function(H){return H.kind==="audio"}).length){T++;var G=l.audioContext.createMediaStreamSource(j);l.useGainNode===!0&&G.connect(l.gainNode),l.audioSources.push(G)}}),!!T)return l.audioDestination=l.audioContext.createMediaStreamDestination(),l.audioSources.forEach(function(j){j.connect(l.audioDestination)}),l.audioDestination.stream}function W(T){var j=document.createElement("video");return q(T,j),j.className=r,j.muted=!0,j.volume=0,j.width=T.width||l.width||360,j.height=T.height||l.height||240,j.play(),j}this.appendStreams=function(T){if(!T)throw"First parameter is required.";T instanceof Array||(T=[T]),T.forEach(function(j){var G=new S;if(j.getTracks().filter(function(re){return re.kind==="video"}).length){var H=W(j);H.stream=j,M.push(H),G.addTrack(j.getTracks().filter(function(re){return re.kind==="video"})[0])}if(j.getTracks().filter(function(re){return re.kind==="audio"}).length){var ne=l.audioContext.createMediaStreamSource(j);l.audioDestination=l.audioContext.createMediaStreamDestination(),ne.connect(l.audioDestination),G.addTrack(l.audioDestination.stream.getTracks().filter(function(re){return re.kind==="audio"})[0])}f.push(G)})},this.releaseStreams=function(){M=[],_=!0,l.gainNode&&(l.gainNode.disconnect(),l.gainNode=null),l.audioSources.length&&(l.audioSources.forEach(function(T){T.disconnect()}),l.audioSources=[]),l.audioDestination&&(l.audioDestination.disconnect(),l.audioDestination=null),l.audioContext&&l.audioContext.close(),l.audioContext=null,o.clearRect(0,0,L.width,L.height),L.stream&&(L.stream.stop(),L.stream=null)},this.resetVideoStreams=function(T){T&&!(T instanceof Array)&&(T=[T]),K(T)};function K(T){M=[],T=T||f,T.forEach(function(j){if(j.getTracks().filter(function(H){return H.kind==="video"}).length){var G=W(j);G.stream=j,M.push(G)}})}this.name="MultiStreamsMixer",this.toString=function(){return this.name},this.getMixedStream=V}typeof t>"u"&&(e.exports=Re);/**
 * MultiStreamRecorder can record multiple videos in single container.
 * @summary Multi-videos recorder.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MultiStreamRecorder
 * @class
 * @example
 * var options = {
 *     mimeType: 'video/webm'
 * }
 * var recorder = new MultiStreamRecorder(ArrayOfMediaStreams, options);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStreams} mediaStreams - Array of MediaStreams.
 * @param {object} config - {disableLogs:true, frameInterval: 1, mimeType: "video/webm"}
 */function rt(f,r){f=f||[];var c=this,M,_;r=r||{elementClass:"multi-streams-mixer",mimeType:"video/webm",video:{width:360,height:240}},r.frameInterval||(r.frameInterval=10),r.video||(r.video={}),r.video.width||(r.video.width=360),r.video.height||(r.video.height=240),this.record=function(){M=new Re(f,r.elementClass||"multi-streams-mixer"),L().length&&(M.frameInterval=r.frameInterval||10,M.width=r.video.width||360,M.height=r.video.height||240,M.startDrawingFrames()),r.previewStream&&typeof r.previewStream=="function"&&r.previewStream(M.getMixedStream()),_=new U(M.getMixedStream(),r),_.record()};function L(){var o=[];return f.forEach(function(l){O(l,"video").forEach(function(R){o.push(R)})}),o}this.stop=function(o){_&&_.stop(function(l){c.blob=l,o(l),c.clearRecordedData()})},this.pause=function(){_&&_.pause()},this.resume=function(){_&&_.resume()},this.clearRecordedData=function(){_&&(_.clearRecordedData(),_=null),M&&(M.releaseStreams(),M=null)},this.addStreams=function(o){if(!o)throw"First parameter is required.";o instanceof Array||(o=[o]),f.concat(o),!(!_||!M)&&(M.appendStreams(o),r.previewStream&&typeof r.previewStream=="function"&&r.previewStream(M.getMixedStream()))},this.resetVideoStreams=function(o){M&&(o&&!(o instanceof Array)&&(o=[o]),M.resetVideoStreams(o))},this.getMixer=function(){return M},this.name="MultiStreamRecorder",this.toString=function(){return this.name}}typeof t<"u"&&(t.MultiStreamRecorder=rt);/**
 * RecordRTCPromisesHandler adds promises support in {@link RecordRTC}. Try a {@link https://github.com/muaz-khan/RecordRTC/blob/master/simple-demos/RecordRTCPromisesHandler.html|demo here}
 * @summary Promises for {@link RecordRTC}
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCPromisesHandler
 * @class
 * @example
 * var recorder = new RecordRTCPromisesHandler(mediaStream, options);
 * recorder.startRecording()
 *         .then(successCB)
 *         .catch(errorCB);
 * // Note: You can access all RecordRTC API using "recorder.recordRTC" e.g. 
 * recorder.recordRTC.onStateChanged = function(state) {};
 * recorder.recordRTC.setRecordingDuration(5000);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 * @throws Will throw an error if "new" keyword is not used to initiate "RecordRTCPromisesHandler". Also throws error if first argument "MediaStream" is missing.
 * @requires {@link RecordRTC}
 */function mt(f,r){if(!this)throw'Use "new RecordRTCPromisesHandler()"';if(typeof f>"u")throw'First argument "MediaStream" is required.';var c=this;c.recordRTC=new t(f,r),this.startRecording=function(){return new Promise(function(M,_){try{c.recordRTC.startRecording(),M()}catch(L){_(L)}})},this.stopRecording=function(){return new Promise(function(M,_){try{c.recordRTC.stopRecording(function(L){if(c.blob=c.recordRTC.getBlob(),!c.blob||!c.blob.size){_("Empty blob.",c.blob);return}M(L)})}catch(L){_(L)}})},this.pauseRecording=function(){return new Promise(function(M,_){try{c.recordRTC.pauseRecording(),M()}catch(L){_(L)}})},this.resumeRecording=function(){return new Promise(function(M,_){try{c.recordRTC.resumeRecording(),M()}catch(L){_(L)}})},this.getDataURL=function(M){return new Promise(function(_,L){try{c.recordRTC.getDataURL(function(o){_(o)})}catch(o){L(o)}})},this.getBlob=function(){return new Promise(function(M,_){try{M(c.recordRTC.getBlob())}catch(L){_(L)}})},this.getInternalRecorder=function(){return new Promise(function(M,_){try{M(c.recordRTC.getInternalRecorder())}catch(L){_(L)}})},this.reset=function(){return new Promise(function(M,_){try{M(c.recordRTC.reset())}catch(L){_(L)}})},this.destroy=function(){return new Promise(function(M,_){try{M(c.recordRTC.destroy())}catch(L){_(L)}})},this.getState=function(){return new Promise(function(M,_){try{M(c.recordRTC.getState())}catch(L){_(L)}})},this.blob=null,this.version="5.6.2"}typeof t<"u"&&(t.RecordRTCPromisesHandler=mt);/**
 * WebAssemblyRecorder lets you create webm videos in JavaScript via WebAssembly. The library consumes raw RGBA32 buffers (4 bytes per pixel) and turns them into a webm video with the given framerate and quality. This makes it compatible out-of-the-box with ImageData from a CANVAS. With realtime mode you can also use webm-wasm for streaming webm videos.
 * @summary Video recording feature in Chrome, Firefox and maybe Edge.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WebAssemblyRecorder
 * @class
 * @example
 * var recorder = new WebAssemblyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {webAssemblyPath:'webm-wasm.wasm',workerPath: 'webm-worker.js', frameRate: 30, width: 1920, height: 1080, bitrate: 1024, realtime: true}
 */function st(f,r){(typeof ReadableStream>"u"||typeof WritableStream>"u")&&console.error("Following polyfill is strongly recommended: https://unpkg.com/@mattiasbuelens/web-streams-polyfill/dist/polyfill.min.js"),r=r||{},r.width=r.width||640,r.height=r.height||480,r.frameRate=r.frameRate||30,r.bitrate=r.bitrate||1200,r.realtime=r.realtime||!0;var c;function M(){return new ReadableStream({start:function(v){var S=document.createElement("canvas"),k=document.createElement("video"),q=!0;k.srcObject=f,k.muted=!0,k.height=r.height,k.width=r.width,k.volume=0,k.onplaying=function(){S.width=r.width,S.height=r.height;var I=S.getContext("2d"),B=1e3/r.frameRate,V=setInterval(function(){if(c&&(clearInterval(V),v.close()),q&&(q=!1,r.onVideoProcessStarted&&r.onVideoProcessStarted()),I.drawImage(k,0,0),v._controlledReadableStream.state!=="closed")try{v.enqueue(I.getImageData(0,0,r.width,r.height))}catch{}},B)},k.play()}})}var _;function L(v,S){if(!r.workerPath&&!S){c=!1,fetch("https://unpkg.com/webm-wasm@latest/dist/webm-worker.js").then(function(q){q.arrayBuffer().then(function(I){L(v,I)})});return}if(!r.workerPath&&S instanceof ArrayBuffer){var k=new Blob([S],{type:"text/javascript"});r.workerPath=p.createObjectURL(k)}r.workerPath||console.error("workerPath parameter is missing."),_=new Worker(r.workerPath),_.postMessage(r.webAssemblyPath||"https://unpkg.com/webm-wasm@latest/dist/webm-wasm.wasm"),_.addEventListener("message",function(q){q.data==="READY"?(_.postMessage({width:r.width,height:r.height,bitrate:r.bitrate||1200,timebaseDen:r.frameRate||30,realtime:r.realtime}),M().pipeTo(new WritableStream({write:function(I){if(c){console.error("Got image, but recorder is finished!");return}_.postMessage(I.data.buffer,[I.data.buffer])}}))):q.data&&(o||R.push(q.data))})}this.record=function(){R=[],o=!1,this.blob=null,L(f),typeof r.initCallback=="function"&&r.initCallback()};var o;this.pause=function(){o=!0},this.resume=function(){o=!1};function l(v){if(!_){v&&v();return}_.addEventListener("message",function(S){S.data===null&&(_.terminate(),_=null,v&&v())}),_.postMessage(null)}var R=[];this.stop=function(v){c=!0;var S=this;l(function(){S.blob=new Blob(R,{type:"video/webm"}),v(S.blob)})},this.name="WebAssemblyRecorder",this.toString=function(){return this.name},this.clearRecordedData=function(){R=[],o=!1,this.blob=null},this.blob=null}typeof t<"u"&&(t.WebAssemblyRecorder=st)})(Xr);var fo=Xr.exports;const co="audio";class ho{constructor(){Ge(this,"recorder");Ge(this,"stream");Ge(this,"isRecording");Ge(this,"isStopped");Ge(this,"isPaused");Ge(this,"pauseRecording",async()=>{if(!this.recorder)throw new Error("Cannot pause recording: no recorder");await this.recorder.pauseRecording(),this.isPaused=!0,this.isRecording=!1});Ge(this,"resumeRecording",async()=>{if(!this.recorder)throw new Error("Cannot resume recording: no recorder");await this.recorder.resumeRecording(),this.isPaused=!1,this.isRecording=!0});Ge(this,"startRecording",async()=>{try{this.stream=await navigator.mediaDevices.getUserMedia({audio:!0}),this.recorder=new fo.RecordRTCPromisesHandler(this.stream,{type:co}),this.recorder.startRecording(),this.isRecording=!0,this.isStopped=!1}catch(t){throw this.isRecording=!1,this.isStopped=!0,new Error(`Error starting recording: ${t.message}`)}});Ge(this,"stopRecording",async t=>{var n;if(!this.isRecording||!this.recorder)throw new Error("Cannot stop recording: no recorder");try{await this.recorder.stopRecording();const i=await this.recorder.getBlob();t(i),(n=this.stream)==null||n.getTracks().forEach(s=>{s.stop()}),this.recorder=null,this.stream=null,this.isRecording=!1,this.isStopped=!0,this.isPaused=!1}catch(i){throw this.isRecording=!1,this.isStopped=!0,new Error(`Error stopping recording: ${i.message}`)}});Ge(this,"abortRecording",async()=>{if(!this.isRecording||!this.recorder)throw new Error("Cannot stop recording: no recorder");await this.recorder.stopRecording(),this.recorder=null,this.stream=null,this.isRecording=!1,this.isStopped=!0,this.isPaused=!1});this.recorder=null,this.stream=null,this.isRecording=!1,this.isStopped=!0,this.isPaused=!1}}let po=yt({scale:1,isDragging:!1,shiftPoint:{x:0,y:0},lastShiftPoint:{x:0,y:0},dragStartPoint:{x:0,y:0}}),Zr=yt(!1),es=yt(!1),Ln=yt(118.5),ts=yt({airspace:yt("KSFO"),frequency:yt(118.5)}),go=yt({doInitialDraw:!0,lastDraw:0}),En=yt("");const yo=1,We=6076.115,ur=1.68781*yo,vo=10;function ns(e){return e!=null}function mo(e){return(e+360+90)%360}const bo=e=>e*180/Math.PI,Ai=e=>e*Math.PI/180;function ct(e,t,n){const i=Ai(n),s=e[0]+t*Math.sin(i),a=e[1]+t*Math.cos(i);return[s,a]}function wo(e,t){let n=t[0]-e[0],i=t[1]-e[1];return(bo(Math.atan2(i,n))+360)%360}function So(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}function vn(e){return(e+180)%360}function ki(e){let t=e.pos,n=e.length,i=ct(t,n*.5,vn(e.heading)),s=ct(t,n*.5,e.heading),a=18,u=[],d=6/4;for(let b=1;b<4;b+=1){let $=b*d+0;u.push(ct(i,n+We*$,vn(e.heading)))}let m=ct(i,n/2+We*20,vn(e.heading)),C=ct(i,n/2+We*a,vn(e.heading+5)),p=ct(i,n/2+We*a,vn((e.heading+355)%360));return{start:i,end:s,ils:{altitudePoints:u,end:m,maxAngle:C,minAngle:p}}}function Ro(e,t){return Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)}function Et(e,t){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}function ht(e){const t=e<0;let n=Math.abs(e),i=Math.floor(n/1e3),s=(i%60).toString().padStart(2,"0"),u=`${Math.floor(i/60).toString().padStart(2,"0")}:${s}`;return t&&(u=`-${u}`),u}function To(e){switch(e){case"before-turn":return"ILS";case"turning":return"TRN";case"correcting":return"ALN";case"localizer":return"LOC";case"glideslope":return"GLS";default:return"UKN"}}function Co(e){switch(e){case"armed":return"ARM";case"stopped":return"STP";case"holding":return"HLD";case"override":return"OVR";default:return"UKN"}}function Ao(e){let t=localStorage.getItem(e);return ns(t)?JSON.parse(t):null}function dr(e,t){let n=JSON.stringify(t);localStorage.setItem(e,n)}function Pi(e){const t=`storage-${Nr()}`;let[n,i]=Se(e);const s=Ao(t);return ns(s)&&i(s),gt(()=>dr(t,n())),[n,a=>{i(a),dr(t,n())}]}var _n=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},cn=typeof window>"u"||"Deno"in globalThis;function Ne(){}function ko(e,t){return typeof e=="function"?e(t):e}function Oi(e){return typeof e=="number"&&e>=0&&e!==1/0}function is(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Jt(e,t){return typeof e=="function"?e(t):e}function Ye(e,t){return typeof e=="function"?e(t):e}function fr(e,t){const{type:n="all",exact:i,fetchStatus:s,predicate:a,queryKey:u,stale:d}=e;if(u){if(i){if(t.queryHash!==Vi(u,t.options))return!1}else if(!An(t.queryKey,u))return!1}if(n!=="all"){const m=t.isActive();if(n==="active"&&!m||n==="inactive"&&m)return!1}return!(typeof d=="boolean"&&t.isStale()!==d||s&&s!==t.state.fetchStatus||a&&!a(t))}function cr(e,t){const{exact:n,status:i,predicate:s,mutationKey:a}=e;if(a){if(!t.options.mutationKey)return!1;if(n){if(Cn(t.options.mutationKey)!==Cn(a))return!1}else if(!An(t.options.mutationKey,a))return!1}return!(i&&t.state.status!==i||s&&!s(t))}function Vi(e,t){return((t==null?void 0:t.queryKeyHashFn)||Cn)(e)}function Cn(e){return JSON.stringify(e,(t,n)=>Di(n)?Object.keys(n).sort().reduce((i,s)=>(i[s]=n[s],i),{}):n)}function An(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?!Object.keys(t).some(n=>!An(e[n],t[n])):!1}function rs(e,t){if(e===t)return e;const n=hr(e)&&hr(t);if(n||Di(e)&&Di(t)){const i=n?e:Object.keys(e),s=i.length,a=n?t:Object.keys(t),u=a.length,d=n?[]:{};let m=0;for(let C=0;C<u;C++){const p=n?C:a[C];(!n&&i.includes(p)||n)&&e[p]===void 0&&t[p]===void 0?(d[p]=void 0,m++):(d[p]=rs(e[p],t[p]),d[p]===e[p]&&e[p]!==void 0&&m++)}return s===u&&m===s?e:d}return t}function Mi(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function hr(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Di(e){if(!pr(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!pr(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function pr(e){return Object.prototype.toString.call(e)==="[object Object]"}function Po(e){return new Promise(t=>{setTimeout(t,e)})}function Li(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?rs(e,t):t}function Oo(e,t,n=0){const i=[...e,t];return n&&i.length>n?i.slice(1):i}function Mo(e,t,n=0){const i=[t,...e];return n&&i.length>n?i.slice(0,-1):i}var Ki=Symbol();function ss(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===Ki?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var _t,wt,Xt,Ar,Do=(Ar=class extends _n{constructor(){super();X(this,_t);X(this,wt);X(this,Xt);J(this,Xt,t=>{if(!cn&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){h(this,wt)||this.setEventListener(h(this,Xt))}onUnsubscribe(){var t;this.hasListeners()||((t=h(this,wt))==null||t.call(this),J(this,wt,void 0))}setEventListener(t){var n;J(this,Xt,t),(n=h(this,wt))==null||n.call(this),J(this,wt,t(i=>{typeof i=="boolean"?this.setFocused(i):this.onFocus()}))}setFocused(t){h(this,_t)!==t&&(J(this,_t,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof h(this,_t)=="boolean"?h(this,_t):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},_t=new WeakMap,wt=new WeakMap,Xt=new WeakMap,Ar),Gi=new Do,Zt,St,en,kr,Lo=(kr=class extends _n{constructor(){super();X(this,Zt,!0);X(this,St);X(this,en);J(this,en,t=>{if(!cn&&window.addEventListener){const n=()=>t(!0),i=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",i,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",i)}}})}onSubscribe(){h(this,St)||this.setEventListener(h(this,en))}onUnsubscribe(){var t;this.hasListeners()||((t=h(this,St))==null||t.call(this),J(this,St,void 0))}setEventListener(t){var n;J(this,en,t),(n=h(this,St))==null||n.call(this),J(this,St,t(this.setOnline.bind(this)))}setOnline(t){h(this,Zt)!==t&&(J(this,Zt,t),this.listeners.forEach(i=>{i(t)}))}isOnline(){return h(this,Zt)}},Zt=new WeakMap,St=new WeakMap,en=new WeakMap,kr),Gn=new Lo;function Ei(){let e,t;const n=new Promise((s,a)=>{e=s,t=a});n.status="pending",n.catch(()=>{});function i(s){Object.assign(n,s),delete n.resolve,delete n.reject}return n.resolve=s=>{i({status:"fulfilled",value:s}),e(s)},n.reject=s=>{i({status:"rejected",reason:s}),t(s)},n}function Eo(e){return Math.min(1e3*2**e,3e4)}function os(e){return(e??"online")==="online"?Gn.isOnline():!0}var as=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function ci(e){return e instanceof as}function ls(e){let t=!1,n=0,i=!1,s;const a=Ei(),u=g=>{var w;i||($(new as(g)),(w=e.abort)==null||w.call(e))},d=()=>{t=!0},m=()=>{t=!1},C=()=>Gi.isFocused()&&(e.networkMode==="always"||Gn.isOnline())&&e.canRun(),p=()=>os(e.networkMode)&&e.canRun(),b=g=>{var w;i||(i=!0,(w=e.onSuccess)==null||w.call(e,g),s==null||s(),a.resolve(g))},$=g=>{var w;i||(i=!0,(w=e.onError)==null||w.call(e,g),s==null||s(),a.reject(g))},F=()=>new Promise(g=>{var w;s=y=>{(i||C())&&g(y)},(w=e.onPause)==null||w.call(e)}).then(()=>{var g;s=void 0,i||(g=e.onContinue)==null||g.call(e)}),E=()=>{if(i)return;let g;const w=n===0?e.initialPromise:void 0;try{g=w??e.fn()}catch(y){g=Promise.reject(y)}Promise.resolve(g).then(b).catch(y=>{var z;if(i)return;const D=e.retry??(cn?0:3),A=e.retryDelay??Eo,O=typeof A=="function"?A(n,y):A,Q=D===!0||typeof D=="number"&&n<D||typeof D=="function"&&D(n,y);if(t||!Q){$(y);return}n++,(z=e.onFail)==null||z.call(e,n,y),Po(O).then(()=>C()?void 0:F()).then(()=>{t?$(y):E()})})};return{promise:a,cancel:u,continue:()=>(s==null||s(),a),cancelRetry:d,continueRetry:m,canStart:p,start:()=>(p()?E():F().then(E),a)}}function _o(){let e=[],t=0,n=d=>{d()},i=d=>{d()},s=d=>setTimeout(d,0);const a=d=>{t?e.push(d):s(()=>{n(d)})},u=()=>{const d=e;e=[],d.length&&s(()=>{i(()=>{d.forEach(m=>{n(m)})})})};return{batch:d=>{let m;t++;try{m=d()}finally{t--,t||u()}return m},batchCalls:d=>(...m)=>{a(()=>{d(...m)})},schedule:a,setNotifyFunction:d=>{n=d},setBatchNotifyFunction:d=>{i=d},setScheduler:d=>{s=d}}}var ke=_o(),It,Pr,us=(Pr=class{constructor(){X(this,It)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Oi(this.gcTime)&&J(this,It,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(cn?1/0:5*60*1e3))}clearGcTimeout(){h(this,It)&&(clearTimeout(h(this,It)),J(this,It,void 0))}},It=new WeakMap,Pr),tn,nn,Be,Ae,kn,$t,He,dt,Or,Io=(Or=class extends us{constructor(t){super();X(this,He);X(this,tn);X(this,nn);X(this,Be);X(this,Ae);X(this,kn);X(this,$t);J(this,$t,!1),J(this,kn,t.defaultOptions),this.setOptions(t.options),this.observers=[],J(this,Be,t.cache),this.queryKey=t.queryKey,this.queryHash=t.queryHash,J(this,tn,$o(this.options)),this.state=t.state??h(this,tn),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=h(this,Ae))==null?void 0:t.promise}setOptions(t){this.options={...h(this,kn),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&h(this,Be).remove(this)}setData(t,n){const i=Li(this.state.data,t,this.options);return se(this,He,dt).call(this,{data:i,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),i}setState(t,n){se(this,He,dt).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var i,s;const n=(i=h(this,Ae))==null?void 0:i.promise;return(s=h(this,Ae))==null||s.cancel(t),n?n.then(Ne).catch(Ne):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(h(this,tn))}isActive(){return this.observers.some(t=>Ye(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Ki||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!is(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(i=>i.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=h(this,Ae))==null||n.continue()}onOnline(){var n;const t=this.observers.find(i=>i.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=h(this,Ae))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),h(this,Be).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(h(this,Ae)&&(h(this,$t)?h(this,Ae).cancel({revert:!0}):h(this,Ae).cancelRetry()),this.scheduleGc()),h(this,Be).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||se(this,He,dt).call(this,{type:"invalidate"})}fetch(t,n){var m,C,p;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(h(this,Ae))return h(this,Ae).continueRetry(),h(this,Ae).promise}if(t&&this.setOptions(t),!this.options.queryFn){const b=this.observers.find($=>$.options.queryFn);b&&this.setOptions(b.options)}const i=new AbortController,s=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(J(this,$t,!0),i.signal)})},a=()=>{const b=ss(this.options,n),$={queryKey:this.queryKey,meta:this.meta};return s($),J(this,$t,!1),this.options.persister?this.options.persister(b,$,this):b($)},u={fetchOptions:n,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:a};s(u),(m=this.options.behavior)==null||m.onFetch(u,this),J(this,nn,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((C=u.fetchOptions)==null?void 0:C.meta))&&se(this,He,dt).call(this,{type:"fetch",meta:(p=u.fetchOptions)==null?void 0:p.meta});const d=b=>{var $,F,E,g;ci(b)&&b.silent||se(this,He,dt).call(this,{type:"error",error:b}),ci(b)||((F=($=h(this,Be).config).onError)==null||F.call($,b,this),(g=(E=h(this,Be).config).onSettled)==null||g.call(E,this.state.data,b,this)),this.scheduleGc()};return J(this,Ae,ls({initialPromise:n==null?void 0:n.initialPromise,fn:u.fetchFn,abort:i.abort.bind(i),onSuccess:b=>{var $,F,E,g;if(b===void 0){d(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(b)}catch(w){d(w);return}(F=($=h(this,Be).config).onSuccess)==null||F.call($,b,this),(g=(E=h(this,Be).config).onSettled)==null||g.call(E,b,this.state.error,this),this.scheduleGc()},onError:d,onFail:(b,$)=>{se(this,He,dt).call(this,{type:"failed",failureCount:b,error:$})},onPause:()=>{se(this,He,dt).call(this,{type:"pause"})},onContinue:()=>{se(this,He,dt).call(this,{type:"continue"})},retry:u.options.retry,retryDelay:u.options.retryDelay,networkMode:u.options.networkMode,canRun:()=>!0})),h(this,Ae).start()}},tn=new WeakMap,nn=new WeakMap,Be=new WeakMap,Ae=new WeakMap,kn=new WeakMap,$t=new WeakMap,He=new WeakSet,dt=function(t){const n=i=>{switch(t.type){case"failed":return{...i,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...i,fetchStatus:"paused"};case"continue":return{...i,fetchStatus:"fetching"};case"fetch":return{...i,...ds(i.data,this.options),fetchMeta:t.meta??null};case"success":return{...i,data:t.data,dataUpdateCount:i.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const s=t.error;return ci(s)&&s.revert&&h(this,nn)?{...h(this,nn),fetchStatus:"idle"}:{...i,error:s,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...i,isInvalidated:!0};case"setState":return{...i,...t.state}}};this.state=n(this.state),ke.batch(()=>{this.observers.forEach(i=>{i.onQueryUpdate()}),h(this,Be).notify({query:this,type:"updated",action:t})})},Or);function ds(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:os(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function $o(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,i=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var et,Mr,Fo=(Mr=class extends _n{constructor(t={}){super();X(this,et);this.config=t,J(this,et,new Map)}build(t,n,i){const s=n.queryKey,a=n.queryHash??Vi(s,n);let u=this.get(a);return u||(u=new Io({cache:this,queryKey:s,queryHash:a,options:t.defaultQueryOptions(n),state:i,defaultOptions:t.getQueryDefaults(s)}),this.add(u)),u}add(t){h(this,et).has(t.queryHash)||(h(this,et).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=h(this,et).get(t.queryHash);n&&(t.destroy(),n===t&&h(this,et).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){ke.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return h(this,et).get(t)}getAll(){return[...h(this,et).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(i=>fr(n,i))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(i=>fr(t,i)):n}notify(t){ke.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){ke.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){ke.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},et=new WeakMap,Mr),tt,De,Ft,nt,bt,Dr,xo=(Dr=class extends us{constructor(t){super();X(this,nt);X(this,tt);X(this,De);X(this,Ft);this.mutationId=t.mutationId,J(this,De,t.mutationCache),J(this,tt,[]),this.state=t.state||Uo(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){h(this,tt).includes(t)||(h(this,tt).push(t),this.clearGcTimeout(),h(this,De).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){J(this,tt,h(this,tt).filter(n=>n!==t)),this.scheduleGc(),h(this,De).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){h(this,tt).length||(this.state.status==="pending"?this.scheduleGc():h(this,De).remove(this))}continue(){var t;return((t=h(this,Ft))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var s,a,u,d,m,C,p,b,$,F,E,g,w,y,D,A,O,Q,z,N;J(this,Ft,ls({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(x,U)=>{se(this,nt,bt).call(this,{type:"failed",failureCount:x,error:U})},onPause:()=>{se(this,nt,bt).call(this,{type:"pause"})},onContinue:()=>{se(this,nt,bt).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>h(this,De).canRun(this)}));const n=this.state.status==="pending",i=!h(this,Ft).canStart();try{if(!n){se(this,nt,bt).call(this,{type:"pending",variables:t,isPaused:i}),await((a=(s=h(this,De).config).onMutate)==null?void 0:a.call(s,t,this));const U=await((d=(u=this.options).onMutate)==null?void 0:d.call(u,t));U!==this.state.context&&se(this,nt,bt).call(this,{type:"pending",context:U,variables:t,isPaused:i})}const x=await h(this,Ft).start();return await((C=(m=h(this,De).config).onSuccess)==null?void 0:C.call(m,x,t,this.state.context,this)),await((b=(p=this.options).onSuccess)==null?void 0:b.call(p,x,t,this.state.context)),await((F=($=h(this,De).config).onSettled)==null?void 0:F.call($,x,null,this.state.variables,this.state.context,this)),await((g=(E=this.options).onSettled)==null?void 0:g.call(E,x,null,t,this.state.context)),se(this,nt,bt).call(this,{type:"success",data:x}),x}catch(x){try{throw await((y=(w=h(this,De).config).onError)==null?void 0:y.call(w,x,t,this.state.context,this)),await((A=(D=this.options).onError)==null?void 0:A.call(D,x,t,this.state.context)),await((Q=(O=h(this,De).config).onSettled)==null?void 0:Q.call(O,void 0,x,this.state.variables,this.state.context,this)),await((N=(z=this.options).onSettled)==null?void 0:N.call(z,void 0,x,t,this.state.context)),x}finally{se(this,nt,bt).call(this,{type:"error",error:x})}}finally{h(this,De).runNext(this)}}},tt=new WeakMap,De=new WeakMap,Ft=new WeakMap,nt=new WeakSet,bt=function(t){const n=i=>{switch(t.type){case"failed":return{...i,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...i,isPaused:!0};case"continue":return{...i,isPaused:!1};case"pending":return{...i,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...i,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...i,data:void 0,error:t.error,failureCount:i.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),ke.batch(()=>{h(this,tt).forEach(i=>{i.onMutationUpdate(t)}),h(this,De).notify({mutation:this,type:"updated",action:t})})},Dr);function Uo(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Fe,Pn,Lr,qo=(Lr=class extends _n{constructor(t={}){super();X(this,Fe);X(this,Pn);this.config=t,J(this,Fe,new Map),J(this,Pn,Date.now())}build(t,n,i){const s=new xo({mutationCache:this,mutationId:++xn(this,Pn)._,options:t.defaultMutationOptions(n),state:i});return this.add(s),s}add(t){const n=Bn(t),i=h(this,Fe).get(n)??[];i.push(t),h(this,Fe).set(n,i),this.notify({type:"added",mutation:t})}remove(t){var i;const n=Bn(t);if(h(this,Fe).has(n)){const s=(i=h(this,Fe).get(n))==null?void 0:i.filter(a=>a!==t);s&&(s.length===0?h(this,Fe).delete(n):h(this,Fe).set(n,s))}this.notify({type:"removed",mutation:t})}canRun(t){var i;const n=(i=h(this,Fe).get(Bn(t)))==null?void 0:i.find(s=>s.state.status==="pending");return!n||n===t}runNext(t){var i;const n=(i=h(this,Fe).get(Bn(t)))==null?void 0:i.find(s=>s!==t&&s.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}clear(){ke.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}getAll(){return[...h(this,Fe).values()].flat()}find(t){const n={exact:!0,...t};return this.getAll().find(i=>cr(n,i))}findAll(t={}){return this.getAll().filter(n=>cr(t,n))}notify(t){ke.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return ke.batch(()=>Promise.all(t.map(n=>n.continue().catch(Ne))))}},Fe=new WeakMap,Pn=new WeakMap,Lr);function Bn(e){var t;return((t=e.options.scope)==null?void 0:t.id)??String(e.mutationId)}function gr(e){return{onFetch:(t,n)=>{var p,b,$,F,E;const i=t.options,s=($=(b=(p=t.fetchOptions)==null?void 0:p.meta)==null?void 0:b.fetchMore)==null?void 0:$.direction,a=((F=t.state.data)==null?void 0:F.pages)||[],u=((E=t.state.data)==null?void 0:E.pageParams)||[];let d={pages:[],pageParams:[]},m=0;const C=async()=>{let g=!1;const w=A=>{Object.defineProperty(A,"signal",{enumerable:!0,get:()=>(t.signal.aborted?g=!0:t.signal.addEventListener("abort",()=>{g=!0}),t.signal)})},y=ss(t.options,t.fetchOptions),D=async(A,O,Q)=>{if(g)return Promise.reject();if(O==null&&A.pages.length)return Promise.resolve(A);const z={queryKey:t.queryKey,pageParam:O,direction:Q?"backward":"forward",meta:t.options.meta};w(z);const N=await y(z),{maxPages:x}=t.options,U=Q?Mo:Oo;return{pages:U(A.pages,N,x),pageParams:U(A.pageParams,O,x)}};if(s&&a.length){const A=s==="backward",O=A?Bo:yr,Q={pages:a,pageParams:u},z=O(i,Q);d=await D(Q,z,A)}else{const A=e??a.length;do{const O=m===0?u[0]??i.initialPageParam:yr(i,d);if(m>0&&O==null)break;d=await D(d,O),m++}while(m<A)}return d};t.options.persister?t.fetchFn=()=>{var g,w;return(w=(g=t.options).persister)==null?void 0:w.call(g,C,{queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=C}}}function yr(e,{pages:t,pageParams:n}){const i=t.length-1;return t.length>0?e.getNextPageParam(t[i],t,n[i],n):void 0}function Bo(e,{pages:t,pageParams:n}){var i;return t.length>0?(i=e.getPreviousPageParam)==null?void 0:i.call(e,t[0],t,n[0],n):void 0}var ge,Rt,Tt,rn,sn,Ct,on,an,Er,jo=(Er=class{constructor(t={}){X(this,ge);X(this,Rt);X(this,Tt);X(this,rn);X(this,sn);X(this,Ct);X(this,on);X(this,an);J(this,ge,t.queryCache||new Fo),J(this,Rt,t.mutationCache||new qo),J(this,Tt,t.defaultOptions||{}),J(this,rn,new Map),J(this,sn,new Map),J(this,Ct,0)}mount(){xn(this,Ct)._++,h(this,Ct)===1&&(J(this,on,Gi.subscribe(async t=>{t&&(await this.resumePausedMutations(),h(this,ge).onFocus())})),J(this,an,Gn.subscribe(async t=>{t&&(await this.resumePausedMutations(),h(this,ge).onOnline())})))}unmount(){var t,n;xn(this,Ct)._--,h(this,Ct)===0&&((t=h(this,on))==null||t.call(this),J(this,on,void 0),(n=h(this,an))==null||n.call(this),J(this,an,void 0))}isFetching(t){return h(this,ge).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return h(this,Rt).findAll({...t,status:"pending"}).length}getQueryData(t){var i;const n=this.defaultQueryOptions({queryKey:t});return(i=h(this,ge).get(n.queryHash))==null?void 0:i.state.data}ensureQueryData(t){const n=this.getQueryData(t.queryKey);if(n===void 0)return this.fetchQuery(t);{const i=this.defaultQueryOptions(t),s=h(this,ge).build(this,i);return t.revalidateIfStale&&s.isStaleByTime(Jt(i.staleTime,s))&&this.prefetchQuery(i),Promise.resolve(n)}}getQueriesData(t){return h(this,ge).findAll(t).map(({queryKey:n,state:i})=>{const s=i.data;return[n,s]})}setQueryData(t,n,i){const s=this.defaultQueryOptions({queryKey:t}),a=h(this,ge).get(s.queryHash),u=a==null?void 0:a.state.data,d=ko(n,u);if(d!==void 0)return h(this,ge).build(this,s).setData(d,{...i,manual:!0})}setQueriesData(t,n,i){return ke.batch(()=>h(this,ge).findAll(t).map(({queryKey:s})=>[s,this.setQueryData(s,n,i)]))}getQueryState(t){var i;const n=this.defaultQueryOptions({queryKey:t});return(i=h(this,ge).get(n.queryHash))==null?void 0:i.state}removeQueries(t){const n=h(this,ge);ke.batch(()=>{n.findAll(t).forEach(i=>{n.remove(i)})})}resetQueries(t,n){const i=h(this,ge),s={type:"active",...t};return ke.batch(()=>(i.findAll(t).forEach(a=>{a.reset()}),this.refetchQueries(s,n)))}cancelQueries(t={},n={}){const i={revert:!0,...n},s=ke.batch(()=>h(this,ge).findAll(t).map(a=>a.cancel(i)));return Promise.all(s).then(Ne).catch(Ne)}invalidateQueries(t={},n={}){return ke.batch(()=>{if(h(this,ge).findAll(t).forEach(s=>{s.invalidate()}),t.refetchType==="none")return Promise.resolve();const i={...t,type:t.refetchType??t.type??"active"};return this.refetchQueries(i,n)})}refetchQueries(t={},n){const i={...n,cancelRefetch:(n==null?void 0:n.cancelRefetch)??!0},s=ke.batch(()=>h(this,ge).findAll(t).filter(a=>!a.isDisabled()).map(a=>{let u=a.fetch(void 0,i);return i.throwOnError||(u=u.catch(Ne)),a.state.fetchStatus==="paused"?Promise.resolve():u}));return Promise.all(s).then(Ne)}fetchQuery(t){const n=this.defaultQueryOptions(t);n.retry===void 0&&(n.retry=!1);const i=h(this,ge).build(this,n);return i.isStaleByTime(Jt(n.staleTime,i))?i.fetch(n):Promise.resolve(i.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Ne).catch(Ne)}fetchInfiniteQuery(t){return t.behavior=gr(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Ne).catch(Ne)}ensureInfiniteQueryData(t){return t.behavior=gr(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return Gn.isOnline()?h(this,Rt).resumePausedMutations():Promise.resolve()}getQueryCache(){return h(this,ge)}getMutationCache(){return h(this,Rt)}getDefaultOptions(){return h(this,Tt)}setDefaultOptions(t){J(this,Tt,t)}setQueryDefaults(t,n){h(this,rn).set(Cn(t),{queryKey:t,defaultOptions:n})}getQueryDefaults(t){const n=[...h(this,rn).values()];let i={};return n.forEach(s=>{An(t,s.queryKey)&&(i={...i,...s.defaultOptions})}),i}setMutationDefaults(t,n){h(this,sn).set(Cn(t),{mutationKey:t,defaultOptions:n})}getMutationDefaults(t){const n=[...h(this,sn).values()];let i={};return n.forEach(s=>{An(t,s.mutationKey)&&(i={...i,...s.defaultOptions})}),i}defaultQueryOptions(t){if(t._defaulted)return t;const n={...h(this,Tt).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return n.queryHash||(n.queryHash=Vi(n.queryKey,n)),n.refetchOnReconnect===void 0&&(n.refetchOnReconnect=n.networkMode!=="always"),n.throwOnError===void 0&&(n.throwOnError=!!n.suspense),!n.networkMode&&n.persister&&(n.networkMode="offlineFirst"),n.enabled!==!0&&n.queryFn===Ki&&(n.enabled=!1),n}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...h(this,Tt).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){h(this,ge).clear(),h(this,Rt).clear()}},ge=new WeakMap,Rt=new WeakMap,Tt=new WeakMap,rn=new WeakMap,sn=new WeakMap,Ct=new WeakMap,on=new WeakMap,an=new WeakMap,Er),_e,oe,On,Le,xt,ln,At,it,Mn,un,dn,Ut,qt,kt,fn,ue,wn,_i,Ii,$i,Fi,xi,Ui,qi,fs,_r,No=(_r=class extends _n{constructor(t,n){super();X(this,ue);X(this,_e);X(this,oe);X(this,On);X(this,Le);X(this,xt);X(this,ln);X(this,At);X(this,it);X(this,Mn);X(this,un);X(this,dn);X(this,Ut);X(this,qt);X(this,kt);X(this,fn,new Set);this.options=n,J(this,_e,t),J(this,it,null),J(this,At,Ei()),this.options.experimental_prefetchInRender||h(this,At).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(h(this,oe).addObserver(this),vr(h(this,oe),this.options)?se(this,ue,wn).call(this):this.updateResult(),se(this,ue,Fi).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Bi(h(this,oe),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Bi(h(this,oe),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,se(this,ue,xi).call(this),se(this,ue,Ui).call(this),h(this,oe).removeObserver(this)}setOptions(t,n){const i=this.options,s=h(this,oe);if(this.options=h(this,_e).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Ye(this.options.enabled,h(this,oe))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");se(this,ue,qi).call(this),h(this,oe).setOptions(this.options),i._defaulted&&!Mi(this.options,i)&&h(this,_e).getQueryCache().notify({type:"observerOptionsUpdated",query:h(this,oe),observer:this});const a=this.hasListeners();a&&mr(h(this,oe),s,this.options,i)&&se(this,ue,wn).call(this),this.updateResult(n),a&&(h(this,oe)!==s||Ye(this.options.enabled,h(this,oe))!==Ye(i.enabled,h(this,oe))||Jt(this.options.staleTime,h(this,oe))!==Jt(i.staleTime,h(this,oe)))&&se(this,ue,_i).call(this);const u=se(this,ue,Ii).call(this);a&&(h(this,oe)!==s||Ye(this.options.enabled,h(this,oe))!==Ye(i.enabled,h(this,oe))||u!==h(this,kt))&&se(this,ue,$i).call(this,u)}getOptimisticResult(t){const n=h(this,_e).getQueryCache().build(h(this,_e),t),i=this.createResult(n,t);return Qo(this,i)&&(J(this,Le,i),J(this,ln,this.options),J(this,xt,h(this,oe).state)),i}getCurrentResult(){return h(this,Le)}trackResult(t,n){const i={};return Object.keys(t).forEach(s=>{Object.defineProperty(i,s,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(s),n==null||n(s),t[s])})}),i}trackProp(t){h(this,fn).add(t)}getCurrentQuery(){return h(this,oe)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=h(this,_e).defaultQueryOptions(t),i=h(this,_e).getQueryCache().build(h(this,_e),n);return i.fetch().then(()=>this.createResult(i,n))}fetch(t){return se(this,ue,wn).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),h(this,Le)))}createResult(t,n){var x;const i=h(this,oe),s=this.options,a=h(this,Le),u=h(this,xt),d=h(this,ln),C=t!==i?t.state:h(this,On),{state:p}=t;let b={...p},$=!1,F;if(n._optimisticResults){const U=this.hasListeners(),Y=!U&&vr(t,n),te=U&&mr(t,i,n,s);(Y||te)&&(b={...b,...ds(p.data,t.options)}),n._optimisticResults==="isRestoring"&&(b.fetchStatus="idle")}let{error:E,errorUpdatedAt:g,status:w}=b;if(n.select&&b.data!==void 0)if(a&&b.data===(u==null?void 0:u.data)&&n.select===h(this,Mn))F=h(this,un);else try{J(this,Mn,n.select),F=n.select(b.data),F=Li(a==null?void 0:a.data,F,n),J(this,un,F),J(this,it,null)}catch(U){J(this,it,U)}else F=b.data;if(n.placeholderData!==void 0&&F===void 0&&w==="pending"){let U;if(a!=null&&a.isPlaceholderData&&n.placeholderData===(d==null?void 0:d.placeholderData))U=a.data;else if(U=typeof n.placeholderData=="function"?n.placeholderData((x=h(this,dn))==null?void 0:x.state.data,h(this,dn)):n.placeholderData,n.select&&U!==void 0)try{U=n.select(U),J(this,it,null)}catch(Y){J(this,it,Y)}U!==void 0&&(w="success",F=Li(a==null?void 0:a.data,U,n),$=!0)}h(this,it)&&(E=h(this,it),F=h(this,un),g=Date.now(),w="error");const y=b.fetchStatus==="fetching",D=w==="pending",A=w==="error",O=D&&y,Q=F!==void 0,N={status:w,fetchStatus:b.fetchStatus,isPending:D,isSuccess:w==="success",isError:A,isInitialLoading:O,isLoading:O,data:F,dataUpdatedAt:b.dataUpdatedAt,error:E,errorUpdatedAt:g,failureCount:b.fetchFailureCount,failureReason:b.fetchFailureReason,errorUpdateCount:b.errorUpdateCount,isFetched:b.dataUpdateCount>0||b.errorUpdateCount>0,isFetchedAfterMount:b.dataUpdateCount>C.dataUpdateCount||b.errorUpdateCount>C.errorUpdateCount,isFetching:y,isRefetching:y&&!D,isLoadingError:A&&!Q,isPaused:b.fetchStatus==="paused",isPlaceholderData:$,isRefetchError:A&&Q,isStale:Hi(t,n),refetch:this.refetch,promise:h(this,At)};if(this.options.experimental_prefetchInRender){const U=ae=>{N.status==="error"?ae.reject(N.error):N.data!==void 0&&ae.resolve(N.data)},Y=()=>{const ae=J(this,At,N.promise=Ei());U(ae)},te=h(this,At);switch(te.status){case"pending":t.queryHash===i.queryHash&&U(te);break;case"fulfilled":(N.status==="error"||N.data!==te.value)&&Y();break;case"rejected":(N.status!=="error"||N.error!==te.reason)&&Y();break}}return N}updateResult(t){const n=h(this,Le),i=this.createResult(h(this,oe),this.options);if(J(this,xt,h(this,oe).state),J(this,ln,this.options),h(this,xt).data!==void 0&&J(this,dn,h(this,oe)),Mi(i,n))return;J(this,Le,i);const s={},a=()=>{if(!n)return!0;const{notifyOnChangeProps:u}=this.options,d=typeof u=="function"?u():u;if(d==="all"||!d&&!h(this,fn).size)return!0;const m=new Set(d??h(this,fn));return this.options.throwOnError&&m.add("error"),Object.keys(h(this,Le)).some(C=>{const p=C;return h(this,Le)[p]!==n[p]&&m.has(p)})};(t==null?void 0:t.listeners)!==!1&&a()&&(s.listeners=!0),se(this,ue,fs).call(this,{...s,...t})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&se(this,ue,Fi).call(this)}},_e=new WeakMap,oe=new WeakMap,On=new WeakMap,Le=new WeakMap,xt=new WeakMap,ln=new WeakMap,At=new WeakMap,it=new WeakMap,Mn=new WeakMap,un=new WeakMap,dn=new WeakMap,Ut=new WeakMap,qt=new WeakMap,kt=new WeakMap,fn=new WeakMap,ue=new WeakSet,wn=function(t){se(this,ue,qi).call(this);let n=h(this,oe).fetch(this.options,t);return t!=null&&t.throwOnError||(n=n.catch(Ne)),n},_i=function(){se(this,ue,xi).call(this);const t=Jt(this.options.staleTime,h(this,oe));if(cn||h(this,Le).isStale||!Oi(t))return;const i=is(h(this,Le).dataUpdatedAt,t)+1;J(this,Ut,setTimeout(()=>{h(this,Le).isStale||this.updateResult()},i))},Ii=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(h(this,oe)):this.options.refetchInterval)??!1},$i=function(t){se(this,ue,Ui).call(this),J(this,kt,t),!(cn||Ye(this.options.enabled,h(this,oe))===!1||!Oi(h(this,kt))||h(this,kt)===0)&&J(this,qt,setInterval(()=>{(this.options.refetchIntervalInBackground||Gi.isFocused())&&se(this,ue,wn).call(this)},h(this,kt)))},Fi=function(){se(this,ue,_i).call(this),se(this,ue,$i).call(this,se(this,ue,Ii).call(this))},xi=function(){h(this,Ut)&&(clearTimeout(h(this,Ut)),J(this,Ut,void 0))},Ui=function(){h(this,qt)&&(clearInterval(h(this,qt)),J(this,qt,void 0))},qi=function(){const t=h(this,_e).getQueryCache().build(h(this,_e),this.options);if(t===h(this,oe))return;const n=h(this,oe);J(this,oe,t),J(this,On,t.state),this.hasListeners()&&(n==null||n.removeObserver(this),t.addObserver(this))},fs=function(t){ke.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(h(this,Le))}),h(this,_e).getQueryCache().notify({query:h(this,oe),type:"observerResultsUpdated"})})},_r);function Wo(e,t){return Ye(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function vr(e,t){return Wo(e,t)||e.state.data!==void 0&&Bi(e,t,t.refetchOnMount)}function Bi(e,t,n){if(Ye(t.enabled,e)!==!1){const i=typeof n=="function"?n(e):n;return i==="always"||i!==!1&&Hi(e,t)}return!1}function mr(e,t,n,i){return(e!==t||Ye(i.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&Hi(e,n)}function Hi(e,t){return Ye(t.enabled,e)!==!1&&e.isStaleByTime(Jt(t.staleTime,e))}function Qo(e,t){return!Mi(e.getCurrentResult(),t)}function zo(e){return e}function Vo(e,t,n){var m;if(typeof t!="object"||t===null)return;const i=e.getMutationCache(),s=e.getQueryCache(),a=((m=e.getDefaultOptions().hydrate)==null?void 0:m.deserializeData)??zo,u=t.mutations||[],d=t.queries||[];u.forEach(({state:C,...p})=>{var b,$;i.build(e,{...(b=e.getDefaultOptions().hydrate)==null?void 0:b.mutations,...($=n==null?void 0:n.defaultOptions)==null?void 0:$.mutations,...p},C)}),d.forEach(({queryKey:C,state:p,queryHash:b,meta:$,promise:F})=>{var w,y;let E=s.get(b);const g=p.data===void 0?p.data:a(p.data);if(E){if(E.state.dataUpdatedAt<p.dataUpdatedAt){const{fetchStatus:D,...A}=p;E.setState({...A,data:g})}}else E=s.build(e,{...(w=e.getDefaultOptions().hydrate)==null?void 0:w.queries,...(y=n==null?void 0:n.defaultOptions)==null?void 0:y.queries,queryKey:C,queryHash:b,meta:$},{...p,data:g,fetchStatus:"idle"});if(F){const D=Promise.resolve(F).then(a);E.fetch(void 0,{initialPromise:D})}})}var Ko=class extends jo{constructor(e={}){super(e)}},cs=Ni(void 0),Zn=e=>{const t=Wi(cs);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t()},Go=e=>(Ee(t=>(t==null||t(),e.client.mount(),e.client.unmount.bind(e.client))),Nt(()=>e.client.unmount()),pe(cs.Provider,{value:()=>e.client,get children(){return e.children}}));function Ho(e,t){return typeof e=="function"?e(...t):!!e}var Jo=Ni(()=>!1),Yo=()=>Wi(Jo);function Xo(e,t,n,i){if(n===!1)return t;if(typeof n=="function"){const u=n(e.data,t.data);return{...t,data:u}}let s=t.data;if(e.data===void 0)try{s=structuredClone(s)}catch{}const a=zi(s,{key:n})(e.data);return{...t,data:a}}var Zo=(e,t)=>t;function ea(e,t,n){const i=ye(()=>Zn()),s=Yo(),a=ye(()=>{const O=i().defaultQueryOptions(e());return O._optimisticResults=s()?"isRestoring":"optimistic",O.structuralSharing=!1,O}),u=a(),[d,m]=Te(new t(i(),a()));let C=d().getOptimisticResult(a());const[p,b]=Yr(C),$=()=>d().subscribe(Q=>{C=Q,queueMicrotask(()=>{g&&D()})});function F(O){const Q=d().options,z=Q.reconcile;b(N=>Xo(N,O,z===void 0?!1:z,Q.queryHash))}function E(){return[()=>p,O=>{const Q=Mt(p);if(typeof O=="function"&&(O=O(Q)),O!=null&&O.hydrationData){const{hydrationData:z,...N}=O;O=N}F(O)}]}let g=null,w=null;const[y,{refetch:D}]=Fr(()=>{const O=d();return new Promise((Q,z)=>{if(w=Q,!g&&!s()&&(g=$()),O.updateResult(),C.isError&&!C.isFetching&&!s()&&Ho(O.options.throwOnError,[C.error,O.getCurrentQuery()]))return F(C),z(C.error);if(!C.isLoading)return w=null,Q(Zo(O.getCurrentQuery(),C));F(C)})},{storage:E,get deferStream(){return e().deferStream},onHydrated(O,Q){if(Q.value&&"hydrationData"in Q.value&&Vo(i(),{queries:[{...Q.value.hydrationData}]}),g)return;const z={...u};(u.staleTime||!u.initialData)&&Q.value&&(z.refetchOnMount=!1),d().setOptions(z),F(d().getOptimisticResult(z)),g=$()}});Sn(li(i,O=>{g&&g();const Q=new t(O,a());g=$(),m(Q)},{defer:!0})),Sn(li(s,O=>{!O&&!ir&&D()},{defer:!0})),Nt(()=>{g&&(g(),g=null),w&&!ir&&(w(C),w=null)}),Sn(li([d,a],([O,Q])=>{O.setOptions(Q),F(O.getOptimisticResult(Q)),D()},{defer:!0}));const A={get(O,Q){var z,N;return Q==="data"?p.data!==void 0?(z=y.latest)==null?void 0:z.data:(N=y())==null?void 0:N.data:Reflect.get(O,Q)}};return new Proxy(p,A)}function Qt(e,t){return ea(ye(()=>e()),No)}var ta=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var i,s,a;if(Array.isArray(t)){if(i=t.length,i!=n.length)return!1;for(s=i;s--!==0;)if(!e(t[s],n[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(a=Object.keys(t),i=a.length,i!==Object.keys(n).length)return!1;for(s=i;s--!==0;)if(!Object.prototype.hasOwnProperty.call(n,a[s]))return!1;for(s=i;s--!==0;){var u=a[s];if(!e(t[u],n[u]))return!1}return!0}return t!==t&&n!==n};const na=uo(ta),ia=`${window.location.protocol}//${window.location.hostname}:9001`,br=new URLSearchParams(window.location.search),Qe=br.has("api")?br.get("api"):ia,wr="/api/ping";function ra(){return Qt(()=>({queryKey:[wr],queryFn:async()=>{try{const e=await fetch(`${Qe}${wr}`);return e.ok?await e.text()==="pong":!1}catch{return!1}},staleTime:2e3,refetchInterval:2e3,refetchOnMount:"always",refetchOnReconnect:"always",throwOnError:!0}))}const Yt="/api/game/aircraft";function sa(e){return Qt(()=>({queryKey:[Yt],queryFn:async()=>{const t=await fetch(`${Qe}${Yt}`);return t.ok?t.json():[]},initialData:[],staleTime:e(),refetchInterval:e(),refetchOnMount:"always",refetchOnReconnect:"always",throwOnError:!0}))}const Bt="/api/game/flights";function oa(){return Qt(()=>({queryKey:[Bt],queryFn:async()=>{const e=await fetch(`${Qe}${Bt}`);return e.ok?e.json():[]},initialData:[],staleTime:2e3,refetchInterval:2e3,refetchOnMount:"always",refetchOnReconnect:"always",throwOnError:!0}))}const aa="/api/game/flight",la=e=>`/api/game/flight/${e}`,Sr="/api/world";function ei(){return Qt(()=>({queryKey:[Sr],queryFn:async()=>{const e=await fetch(`${Qe}${Sr}`);return e.ok?e.json():null},staleTime:1/0,refetchOnReconnect:"always",throwOnError:!0}))}const Rr="/api/game/points";function ua(){return Qt(()=>({queryKey:[Rr],queryFn:async()=>{const e=await fetch(`${Qe}${Rr}`);return e.ok?e.json():null},staleTime:1e3,refetchInterval:1e3,refetchOnReconnect:"always",throwOnError:!0}))}const Gt="/api/messages";function da(){return Qt(()=>({queryKey:[Gt],queryFn:async()=>{const e=await fetch(`${Qe}${Gt}`);return e.ok?e.json():[]},reconcile:(e,t)=>e&&na(e,t)?e:t,initialData:[],staleTime:500,refetchInterval:500,refetchOnMount:"always",refetchOnReconnect:"always",throwOnError:!0}))}var fa=de('<div id=chatbox><div class=controls><input type=button></div><div class=messages></div><div class=input><input type=text placeholder="Type a message..."><input type=button value=Send>'),ca=de("<div class=message><span class=callsign></span><span class=text>"),ha=de("<span class=frequency>");function pa({sendMessage:e}){let t,n,[i]=Se(Zr),[s]=Se(Ln),[a,u]=Se(En),[d]=Pi(es),[m,C]=Te(!1),[p,b]=Te(""),[$,F]=Te(Date.now()/1e3),[E,g]=Te(new Map);const w=da();function y(N,x){return Math.floor(Math.random()*(x-N+1)+N)}function D(N){if(d()&&"speechSynthesis"in window&&s()===N.frequency)if(window.speechSynthesis.speaking||i())setTimeout(()=>D(N),500);else{const x=new SpeechSynthesisUtterance(N.reply.replace(/[0-9]/g,"$& "));if(E().has(N.id))x.rate=E().get(N.id).rate,x.pitch=E().get(N.id).pitch;else{const U={rate:1*y(100,130)/100,pitch:1.3*y(80,115)/100};g(Y=>Y.set(N.id,U)),x.rate=U.rate,x.pitch=U.pitch}x.volume=.01,window.speechSynthesis.speak(x)}else console.log("Sorry, your browser doesn't support text to speech!")}gt(()=>{for(const N of w.data)N.created.secs>$()&&N.id!=="ATC"&&(N.reply!==""?D(N):u(N.id),F(N.created.secs))});function A(N){N.key==="t"&&n instanceof HTMLInputElement&&document.activeElement!==n?(n.focus(),N.preventDefault()):N.key==="Escape"&&(n.blur(),N.preventDefault())}Jn(()=>{document.addEventListener("keydown",A)}),Nt(()=>{document.removeEventListener("keydown",A)});function O(){a()?b(`${a()} `):b("")}gt(()=>{a()&&O()}),gt(()=>{t instanceof HTMLDivElement&&(s(),m(),w.data.length>0&&t.scrollTo(0,t.scrollHeight))});function Q(){C(N=>!N)}function z(N){N.length===7&&/\w{3}\d{4}/.test(N)?u(N):e(N),O()}return(()=>{var N=fa(),x=N.firstChild,U=x.firstChild,Y=x.nextSibling,te=Y.nextSibling,ae=te.firstChild,ze=ae.nextSibling;U.$$click=Q;var Oe=t;typeof Oe=="function"?Si(Oe,Y):t=Y,ee(Y,()=>w.data.filter(Re=>(m()||Re.frequency===s())&&Re.reply!=="").map(Re=>(()=>{var rt=ca(),mt=rt.firstChild,st=mt.nextSibling;return ee(rt,(()=>{var f=ye(()=>!!m());return()=>f()?(()=>{var r=ha();return ee(r,()=>Re.frequency),r})():null})(),mt),ee(mt,()=>Re.id),ee(st,()=>Re.reply),Ee(f=>{var r=Re.id===a(),c=Re.id==="ATC";return r!==f.e&&rt.classList.toggle("selected",f.e=r),c!==f.t&&mt.classList.toggle("atc",f.t=c),f},{e:void 0,t:void 0}),rt})()));var Xe=n;return typeof Xe=="function"?Si(Xe,ae):n=ae,ae.$$keydown=Re=>Re.key==="Enter"&&z(p()),ae.$$input=Re=>b(Re.currentTarget.value),ze.$$click=()=>z(p()),Ee(()=>N.classList.toggle("live",!!i())),Ee(()=>U.value=m()?"Show Yours":"Show All"),Ee(()=>ae.value=p()),N})()}Dn(["click","input","keydown"]);const Z={line_grey:"#444444",line_blue:"#3087f2",line_red:"#ff2222",line_yellow:"#aaaa00",line_green:"#00aa00",text_red:"#aa2222",text_orange:"#dd9904",text_yellow:"#ffe045",text_green:"#44ff44",text_grey:"#777",text_background:"#000a",special:{terminal:"#555",taxiway:"#555",airspace:"#555",connection:{inactive:"#111"}}};var ga=de("<canvas id=canvas>");const Tr=5;function ya(){let e,[t,n]=Se(po),[i,s]=Se(go),[a,u]=Se(En),[d]=Se(Ln),m=ye(()=>16),C=ye(()=>t().scale>Tr),[p,b]=Te(new Map),[$,F]=Te(!1),E=ye(()=>C()?1e3*.5:1e3*4);const g=sa(E),w=ei();function y(o){return o*.003*t().scale}function D(o){return o/.003/t().scale}function A(o){let l=o[0]+t().shiftPoint.x,R=o[1]-t().shiftPoint.y;return l=y(l),R=y(R),[l,-R]}function O(o){let l=D(o[0]),R=D(-o[1]);return l-=t().shiftPoint.x,R+=t().shiftPoint.y,[l,R]}gt(()=>{n(o=>(o.shiftPoint={x:0,y:0},{...o}))});function Q(o){o.key==="PageUp"?(o.preventDefault(),n(l=>(l.scale=1,l.shiftPoint={x:0,y:0},{...l}))):o.key==="PageDown"?(o.preventDefault(),n(l=>(l.scale=Tr*6,l.shiftPoint={x:0,y:0},{...l}))):o.key==="Control"&&F(l=>!l)}function z(){e.width=e.clientWidth,e.height=e.clientHeight}Jn(()=>{window.addEventListener("resize",z),document.addEventListener("keydown",Q),e instanceof HTMLCanvasElement&&e!==null&&(setInterval(()=>N(e),1e3/30),e.width=e.clientWidth,e.height=e.clientHeight,N(e),e.addEventListener("mousedown",R=>{n(I=>(I.isDragging=!0,I.dragStartPoint={x:R.clientX,y:R.clientY},I.lastShiftPoint.x=y(I.shiftPoint.x),I.lastShiftPoint.y=y(I.shiftPoint.y),{...I}));const v=O([R.offsetX-e.width*.5,R.offsetY-e.height*.5]);let S=null,k=1/0;const q=Math.pow(D(100),2);for(const I of g.data){const B=Ro(v,I.pos);B<=q&&(C()?I.altitude<1e3:I.altitude>=1e3)&&B<k&&(k=B,S=I)}S!==null&&u(S.id)}),e.addEventListener("mouseup",R=>{n(v=>(v.isDragging=!1,{...v}))}),e.addEventListener("mousemove",R=>{t().isDragging&&n(v=>{let S=R.clientX-v.dragStartPoint.x+v.lastShiftPoint.x,k=R.clientY-v.dragStartPoint.y+v.lastShiftPoint.y;return v.shiftPoint.x=D(S),v.shiftPoint.y=D(k),{...v}})}),e.addEventListener("wheel",R=>{n(v=>(R.deltaY>0?v.scale*=.9:v.scale*=1.1,v.scale=Math.max(Math.min(v.scale,50),.07),{...v}))}))}),Nt(()=>{document.removeEventListener("keydown",Q),window.removeEventListener("resize",z)});function N(o){U(o);let l=Date.now();(l-i().lastDraw>E()||i().doInitialDraw)&&s(R=>(b(v=>{for(let S of g.data){const k=v.get(S.id);if(typeof k<"u"){let q=k.at(-1);typeof q<"u"&&l-q.now>1e3*4*2&&k.push({now:l,pos:S.pos}),k.length>10&&v.set(S.id,k.slice(1))}else v.set(S.id,[{now:l,pos:S.pos}])}return v}),R.doInitialDraw=!1,{...R}))}function x(o){o.resetTransform(),o.translate(e.width*.5,e.height*.5),o.lineWidth=1,o.strokeStyle="white",o.fillStyle="white",o.font=`900 ${m()}px monospace`,o.textAlign="center",o.textBaseline="middle"}function U(o){const l=o.width,R=o.height;let v=o.getContext("2d");if(v){if(v.font="900 16px monospace",v.fillStyle="black",v.resetTransform(),v.fillRect(0,0,l,R),x(v),w.data===void 0)return;C()?L(v,w.data,g.data):(_(v,w.data,g.data),Y(v)),M(v,g.data)}}function Y(o){let R=250*.5;if(!$())return;let v=g.data.find(S=>S.id===a());if(v&&(v.state.type==="flying"||v.state.type==="landing")){let S=A(v.pos);o.fillStyle="#888",o.textAlign="center",o.textBaseline="middle";let k=-10;const q=30,I=360/q;for(let B=0;B<I;B++){let V=mo(B*q).toString().padStart(3,"0");V==="000"&&(V="360"),o.fillText(V,Math.cos(Ai(B*q))*(R+k)+S[0],Math.sin(Ai(B*q))*(R+k)+S[1])}}}function te(o,l){x(o);let R=A(l.pos);o.strokeStyle=Z.special.airspace,o.beginPath(),o.arc(R[0],R[1],y(l.radius),0,Math.PI*2),o.stroke()}function ae(o,l){x(o);let R=ki(l),v=A(R.start),S=A(R.end),k={end:A(R.ils.end),maxAngle:A(R.ils.maxAngle),minAngle:A(R.ils.minAngle)};o.strokeStyle="grey",o.fillStyle="grey",o.lineWidth=y(1e3),o.beginPath(),o.moveTo(v[0],v[1]),o.lineTo(S[0],S[1]),o.stroke(),o.fillStyle=Z.line_blue,o.strokeStyle=Z.line_blue,o.lineWidth=1,o.beginPath(),o.moveTo(v[0],v[1]),o.lineTo(k.end[0],k.end[1]),o.stroke(),o.strokeStyle=Z.line_grey,o.beginPath(),o.moveTo(v[0],v[1]),o.lineTo(k.maxAngle[0],k.maxAngle[1]),o.stroke(),o.beginPath(),o.moveTo(v[0],v[1]),o.lineTo(k.minAngle[0],k.minAngle[1]),o.stroke(),o.strokeStyle=Z.line_blue;for(let q of R.ils.altitudePoints){let I=A(q);o.beginPath(),o.arc(I[0],I[1],y(1500),0,Math.PI*2),o.stroke()}}function ze(o,l,R,v){let S=A(R);o.fillStyle=v,o.strokeStyle=v,o.beginPath(),o.arc(S[0],S[1],y(700),0,Math.PI*2),o.fill(),o.beginPath(),o.arc(S[0],S[1],y(2e3),0,Math.PI*2),o.stroke();let k=y(2e3+We*.2);o.textAlign="center",o.textBaseline="bottom";let q=o.measureText(l).width+10;o.fillStyle=Z.text_background,o.fillRect(S[0]-q*.5,S[1]-k-m()*1,q,m()),o.fillStyle=v,o.fillText(l,S[0],S[1]-k)}function Oe(o,l){let R=Z.text_grey,v=Z.special.connection.inactive,S=Z.text_yellow,k=l.state==="active"?R:v,q=g.data.find(I=>I.id===a());q&&q.flight_plan.arriving===l.id&&(k=S),ze(o,l.id,l.pos,k),ze(o,l.id,l.transition,k)}function Xe(o,l){var j,G;const R=l.altitude>1e4,v=a()===l.id,S=l.state.type==="flying"&&l.state.value.enroute,k=l.state.type==="landing"&&l.state.value.state!=="before-turn";let q=p().get(l.id);if(q){const H=Math.max(2,y(750));a()==l.id?o.fillStyle=Z.text_yellow:l.is_colliding?o.fillStyle=Z.text_red:l.flight_plan.departing===((j=w.data)==null?void 0:j.airspace.id)?o.fillStyle=Z.line_blue:o.fillStyle=Z.line_green;for(let ne of q)o.fillRect(A(ne.pos)[0]-H*.5,A(ne.pos)[1]-H*.5,H,H)}let I=A(l.pos);if(l.state.type==="flying"&&a()==l.id){o.strokeStyle="#ffff0033",o.lineWidth=3,o.beginPath(),o.moveTo(I[0],I[1]);for(let H of l.state.value.waypoints.slice().reverse()){let ne=A(H.value.to);o.lineTo(ne[0],ne[1])}o.stroke();for(let H of l.state.value.waypoints.slice().reverse()){o.fillStyle=H.behavior==="goto"?"#ffff00":"#ff0000";let ne=A(H.value.to);o.beginPath(),o.arc(ne[0],ne[1],3,0,Math.PI*2),o.fill()}}x(o),v?(o.fillStyle=Z.line_yellow,o.strokeStyle=Z.line_yellow):l.is_colliding?(o.fillStyle=Z.line_red,o.strokeStyle=Z.line_red):(o.fillStyle=Z.line_green,o.strokeStyle=Z.line_green);const B=Math.max(6,y(3e3));if(o.fillRect(I[0]-B*.5,I[1]-B*.5,B,B),l.state.type==="flying"&&l.is_colliding&&(o.beginPath(),o.arc(I[0],I[1],y(We*4),0,Math.PI*2),o.stroke()),v&&(l.state.type==="flying"||l.state.type==="landing")){const ve=l.speed*ur*180/(2*Math.PI);let me=A(ct(l.pos,ve,l.heading));o.beginPath(),o.arc(me[0],me[1],3,0,Math.PI*2),o.fill()}const V=l.speed*ur*60,ie=ct(l.pos,V,l.heading);let P=A(ie);o.beginPath(),o.moveTo(I[0],I[1]),o.lineTo(P[0],P[1]),o.stroke();let W=y(We*1);if(o.textAlign="left",o.fillStyle=Z.text_green,l.frequency!==d()?o.fillStyle=Z.text_grey:a()==l.id?o.fillStyle=Z.text_yellow:l.is_colliding?o.fillStyle=Z.text_red:l.flight_plan.departing===((G=w.data)==null?void 0:G.airspace.id)&&(o.fillStyle=Z.line_blue),o.fillText(l.id,I[0]+W,I[1]-W),(R||S||k)&&!v)return;let K=" ";if(l.altitude<l.target.altitude?K="":l.altitude>l.target.altitude&&(K=""),o.fillText(Math.round(l.altitude/100).toString().padStart(3,"0")+(R?"":K+Math.round(l.target.altitude/100).toString().padStart(3,"0")),I[0]+W,I[1]-W+m()),a()!==l.id)return;let T=l.state.type==="landing"?To(l.state.value.state):Math.round(l.heading).toString().padStart(3,"0").replace("360","000");o.fillText(T,I[0]+W,I[1]-W+m()*2),o.fillText(Math.round(l.speed).toString(),I[0]+W,I[1]-W+m()*3)}function Re(o,l){let R=A(l.a),v=A(l.b),S=A(l.c),k=A(l.d);o.fillStyle=Z.special.terminal,o.lineWidth=y(200),o.beginPath(),o.moveTo(R[0],R[1]),o.lineTo(v[0],v[1]),o.lineTo(S[0],S[1]),o.lineTo(k[0],k[1]),o.lineTo(R[0],R[1]),o.fill();let q=A(l.apron[0]),I=A(l.apron[1]);o.strokeStyle=Z.line_green,o.lineWidth=2,o.beginPath(),o.moveTo(q[0],q[1]),o.lineTo(I[0],I[1]),o.stroke();for(let B=0;B<l.gates.length;B++){let V=l.gates[B];typeof V<"u"&&rt(o,V)}}function rt(o,l){let R=l.id,v=A(l.pos);o.fillStyle="red",o.beginPath(),o.arc(v[0],v[1],5,0,Math.PI*2),o.fill();let S=16,k=o.measureText(R).width+10;o.fillStyle=Z.text_background,o.fillRect(v[0]-k*.5,v[1]-S*.5-S,k,S),o.fillStyle=Z.text_orange,o.fillText(R,v[0],v[1]-S)}function mt(o,l){x(o);let R=A(l.a),v=A(l.b);o.strokeStyle=Z.special.taxiway,o.lineWidth=y(200),o.beginPath(),o.moveTo(R[0],R[1]),o.lineTo(v[0],v[1]),o.stroke()}function st(o,l){let R=A(l.a),v=A(l.b),S=So(R,v),k=o.measureText(l.id).width+10;o.fillStyle=Z.text_background,o.fillRect(S[0]-k*.5,S[1]-m()*.5,k,m()),o.textAlign="center",o.fillStyle=Z.text_orange,o.fillText(l.id,S[0],S[1])}function f(o,l){x(o);let R=ki(l),v=A(R.start),S=A(R.end),k={end:A(R.ils.end),maxAngle:A(R.ils.maxAngle),minAngle:A(R.ils.minAngle)};o.strokeStyle="#222",o.lineWidth=y(250),o.beginPath(),o.moveTo(v[0],v[1]),o.lineTo(S[0],S[1]),o.stroke();let q=o.measureText(l.id).width+10;o.fillStyle=Z.text_background,o.fillRect(v[0]-q*.5,v[1]-m()*.5,q,m()),o.textAlign="center",o.fillStyle=Z.text_orange,o.fillText(l.id,v[0],v[1]),o.fillStyle=Z.line_blue,o.strokeStyle=Z.line_blue,o.lineWidth=1,o.beginPath(),o.moveTo(v[0],v[1]),o.lineTo(k.end[0],k.end[1]),o.stroke()}function r(o,l){const R=a()===l.id;x(o);let v=A(l.pos),S=a()==l.id?Z.text_yellow:"#ffffff",k=l.frequency!==d()?Z.text_grey:S;if(l.state.type==="taxiing"&&a()==l.id){o.strokeStyle="#ffff0088",o.lineWidth=y(50),o.beginPath(),o.moveTo(v[0],v[1]);for(let W of l.state.value.waypoints.slice().reverse()){let K=A(W.value);o.lineTo(K[0],K[1])}o.stroke();for(let W of l.state.value.waypoints.slice().reverse()){W.behavior==="goto"||W.behavior==="park"?o.fillStyle=Z.line_green:W.behavior==="holdshort"?o.fillStyle=Z.line_red:o.fillStyle=Z.line_yellow;let K=A(W.value);o.beginPath(),o.arc(K[0],K[1],y(40),0,Math.PI*2),o.fill()}for(let W of l.state.value.waypoints.slice().reverse().filter(K=>K.behavior==="holdshort")){W.behavior==="goto"||W.behavior==="park"?o.fillStyle=Z.line_yellow:W.behavior==="holdshort"&&(o.fillStyle=Z.line_red);let K=A(W.value);o.beginPath(),o.arc(K[0],K[1],3,0,Math.PI*2),o.fill()}}x(o),o.fillStyle=S,o.strokeStyle=S,o.beginPath(),o.arc(v[0],v[1],y(50),0,Math.PI*2),o.fill(),o.strokeStyle=S,o.lineWidth=2;const I=ct(l.pos,400,l.heading);let B=A(I);if(o.beginPath(),o.moveTo(v[0],v[1]),o.lineTo(B[0],B[1]),o.stroke(),l.state.type==="parked"&&!l.state.value.active)return;let V=y(100);o.textAlign="left",o.fillStyle=S;let ie=o.measureText(l.id).width+10;if(o.fillStyle=Z.text_background,o.fillRect(v[0]+V*.5,v[1]-V-m()*.5,ie,m()),o.fillStyle=k,o.fillText(l.id,v[0]+V,v[1]-V),o.fillStyle=S,l.altitude>0){let W=" ";l.altitude<l.target.altitude?W="":l.altitude>l.target.altitude&&(W=""),o.fillText(Math.round(l.altitude/100).toString().padStart(3,"0")+W+Math.round(l.target.altitude/100).toString().padStart(3,"0"),v[0]+V,v[1]-V+m())}else if(l.state.type==="taxiing"&&R&&$()){let W=Co(l.state.value.state),K=o.measureText(W).width+10;o.fillStyle=Z.text_background,o.fillRect(v[0]+V*.5,v[1]-V-m()*.5+m(),K,m()),o.fillStyle=S,o.fillText(W,v[0]+V,v[1]-V+m())}}function c(o,l){x(o);let R=A(l.pos);l.state.type==="taxiing"&&a()==l.id&&(o.strokeStyle="#ff990033",o.lineWidth=3,o.beginPath(),o.moveTo(R[0],R[1]))}function M(o,l){let R=l.filter(v=>v.is_colliding).map(v=>v.id);if(R.length>0){o.font="900 24px monospace";let v=`SEPARATION WARNING: ${R.join(", ")}`;o.fillStyle="red",o.textAlign="center",o.fillText(v,0,-e.height*.5+100)}}function _(o,l,R){let v=l.airspace;te(o,v);for(let S of v.airports)for(let k of S.runways)ae(o,k);for(let S of l.connections)Oe(o,S);for(let S of R.filter(k=>k.altitude>=1e3&&k.id!==a()))Xe(o,S);for(let S of R.filter(k=>k.altitude>=1e3&&k.id===a()))Xe(o,S);for(let S of R.filter(k=>k.id==a()))c(o,S)}function L(o,l,R){let v=l.airspace;te(o,v);for(let S of v.airports){for(let k of S.taxiways)mt(o,k);for(let k of S.runways)f(o,k);for(let k of S.terminals)Re(o,k);for(let k of S.taxiways)st(o,k)}for(let S of R.filter(k=>k.altitude<1e3&&k.id!==a()))r(o,S);for(let S of R.filter(k=>k.altitude<1e3&&k.id===a()))r(o,S)}return(()=>{var o=ga(),l=e;return typeof l=="function"?Si(l,o):e=o,o})()}function va(e){return e.type==="flying"}function hs(e){return e.type==="taxiing"}var Cr=de("<span>"),ma=de("<div class=strip><div class=vertical><span class=callsign></span><span></span></div><div class=vertical></div><div class=vertical><span></span><span></span></div><div class=vertical><span class=frequency></span><span class=timer>"),ba=de("<div id=stripboard><div class=header>Yours: <!> (All: <!>)"),wa=de("<div class=header>Colliding"),Sa=de("<div class=header>Selected"),Ra=de("<div class=header>");const ji=()=>({Selected:[],Colliding:[],Inbound:[],Approach:[],Landing:[],Departure:[],Outbound:[],Parked:[],Ground:[],Takeoff:[],None:[]}),Ta=()=>{const e=ji();let t={};return Object.keys(e).forEach(n=>{t[n]=!1}),t};function Ca(e,t,n){const i=e.state.type==="landing",s=e.state.type==="taxiing",a=e.state.type==="parked",u=(()=>{if(hs(e.state)){const $=e.state.value.waypoints[0];return typeof $<"u"&&$.kind==="runway"&&e.state.value.waypoints.length==1||e.state.value.current.kind==="runway"}else return!1})(),d=e.state.type==="flying"?!e.state.value.enroute:!0,m=d&&t===e.flight_plan.departing,C=t===e.flight_plan.departing,p=t===e.flight_plan.arriving,b=e.id===n;return e.is_colliding?"Colliding":d&&i?"Landing":s||a?u&&m?"Takeoff":d?e.state.type==="parked"?e.state.value.active||b?"Parked":"None":"Ground":"None":C?d?"Departure":"Outbound":p?d?"Approach":"Inbound":b?"Selected":"None"}function hi({strip:e}){let[t]=Se(Ln),[n,i]=Se(En),[s]=Se(ts),[a]=Se(s().airspace);const u=ei();if(!u.data)return null;let d="--:--";if(va(e.state))if(e.state.value.enroute&&e.state.value.waypoints.length>0){let E=e.pos,g=0,w=e.state.value.waypoints.slice();w.reverse(),w.forEach(A=>{g+=Et(E,A.value.to),E=A.value.to});let D=g/We/(e.speed*vo)*1e3*60*60;d=ht(D)}else if(!e.state.value.enroute&&e.state.value.waypoints.length>0){let E=e.pos,g=0,w=e.state.value.waypoints.at(-1);typeof w<"u"&&(g+=Et(E,w.value.to));let D=g/We/e.speed*1e3*60*60;d=ht(D)}else d="--:--";else if(hs(e.state)&&e.speed>0){if(e.state.value.waypoints.length>0){let E=e.pos,g=0,w=e.state.value.waypoints.slice();w.reverse(),w.forEach(A=>{g+=Et(E,A.value),E=A.value});let D=g/We/e.speed*1e3*60*60;d=ht(D)}}else if(e.state.type==="landing"){let w=Et(e.pos,ki(e.state.value.runway).start)/We/e.speed*1e3*60*60;d=ht(w)}let m="",C="",p=ye(()=>e.frequency!==t()||d.startsWith("-")&&d!=="--:--"||e.state.type==="parked"&&!e.state.value.active);if(e.state.type==="landing")m="ILS",C=e.state.value.runway.id;else if(e.state.type==="taxiing"){let E=e.state.value.current;E.kind==="gate"?m="GATE":E.kind==="runway"?m="RNWY":E.kind==="taxiway"?m="TXWY":E.kind==="apron"&&(m="APRN"),C=E.name}else e.state.type==="parked"&&(m="PARK",C=e.state.value.at.name);let b=Et(e.pos,u.data.airspace.pos),$="";if((e.state.type==="flying"||e.state.type==="landing")&&($=(b/We).toFixed(1).slice(0,4),$.endsWith(".")&&($=$.replace("."," ")),$=`${$} NM`),(e.state.type==="parked"&&e.state.value.active||e.state.type==="taxiing")&&e.flight_plan.arriving!==a()){const E=u.data.connections.find(g=>g.id===e.flight_plan.arriving);if(E!==void 0){const g=wo([0,0],E.pos),w=(360-Math.round(g)+90)%360;let y=1/0,D=w;for(const A of u.data.airspace.airports.flatMap(O=>O.runways)){let O=Math.abs(A.heading-w);O<y&&(y=O,D=A.heading)}$=`FOR ${D.toString().slice(0,2)}`}}function F(){i(e.id)}return(()=>{var E=ma(),g=E.firstChild,w=g.firstChild,y=w.nextSibling,D=g.nextSibling,A=D.nextSibling,O=A.firstChild,Q=O.nextSibling,z=A.nextSibling,N=z.firstChild,x=N.nextSibling;return E.$$mousedown=F,ee(w,()=>e.id),ee(y,$),ee(D,pe(Wt,{get when(){return!(e.state.type==="parked"&&e.state.value.active===!1)},get children(){return[(()=>{var U=Cr();return ee(U,()=>e.flight_plan.departing),U})(),(()=>{var U=Cr();return ee(U,()=>e.flight_plan.arriving),U})()]}})),ee(O,m),ee(Q,C),ee(N,()=>e.frequency),ee(x,d),Ee(U=>{var Y=!!p(),te=!!e.is_colliding,ae=n()===e.id,ze=a()===e.flight_plan.departing;return Y!==U.e&&E.classList.toggle("theirs",U.e=Y),te!==U.t&&E.classList.toggle("colliding",U.t=te),ae!==U.a&&E.classList.toggle("selected",U.a=ae),ze!==U.o&&E.classList.toggle("departure",U.o=ze),U},{e:void 0,t:void 0,a:void 0,o:void 0}),E})()}function Aa(){let[e,t]=Te(ji(),{equals:!1}),n=ye(()=>Object.entries(e())),[i]=Se(En),[s]=Se(ts),[a]=Se(s().airspace),[u,d]=Te(Ta());const m=Qt(()=>({queryKey:[Yt],initialData:[]})),C=ei();gt(()=>{var $;const b=($=C.data)==null?void 0:$.airspace;if(b&&m.data.length>0){let F=ji();for(let w of m.data){let y=Ca(w,a(),i());F[y].push(w)}const E=(w,y)=>(""+w.id).localeCompare(y.id),g=w=>(y,D)=>{let A=Et(y.pos,b.pos),O=Et(D.pos,b.pos);return w?A-O:O-A};Object.entries(F).forEach(([w,y])=>{y.sort(g(!1)),t({...F,[w]:y})}),F.Departure.sort(g(!0)),F.Outbound.sort(g(!0)),F.Parked.sort(E),F.Ground.sort(E),t(F)}});function p(b){d({...u(),[b]:!u()[b]})}return(()=>{var b=ba(),$=b.firstChild,F=$.firstChild,E=F.nextSibling,g=E.nextSibling,w=g.nextSibling;return w.nextSibling,ee($,()=>m.data.length-e().None.length,E),ee($,()=>m.data.length,w),ee(b,(()=>{var y=ye(()=>e().Colliding.length>0);return()=>y()?[wa(),ye(()=>e().Colliding.map(D=>pe(hi,{strip:D})))]:null})(),null),ee(b,(()=>{var y=ye(()=>e().Selected.length>0);return()=>y()?[Sa(),ye(()=>e().Selected.map(D=>pe(hi,{strip:D})))]:null})(),null),ee(b,()=>n().map(([y,D])=>y!=="None"&&y!=="Selected"&&y!=="Colliding"?[(()=>{var A=Ra();return A.$$click=()=>p(y),ee(A,()=>u()[y]?"- ":D.length==0?" ":" ",null),ee(A,y,null),ee(A,()=>D.length>0?` (${D.length})`:"",null),A})(),pe(Wt,{get when(){return!u()[y]},get children(){return D.map(A=>pe(hi,{strip:A}))}})]:null),null),b})()}Dn(["mousedown","click"]);var ka=e=>(typeof e.clear=="function"||(e.clear=()=>{let t;for(;t=e.key(0);)e.removeItem(t)}),e),Pa=["clear","getItem","getAll","setItem","removeItem","key","getLength"],Oa=e=>(e.withOptions=t=>Pa.reduce((n,i)=>(typeof e[i]=="function"&&(n[i]=(...s)=>(s[e[i].length-1]=t,e[i](...s))),n),{get length(){return e.length},withOptions:n=>e.withOptions(n)}),e),Ma={domain:"Domain",expires:"Expires",path:"Path",secure:"Secure",httpOnly:"HttpOnly",maxAge:"Max-Age",sameSite:"SameSite"};function Da(e){if(!e)return"";const t=Object.entries(e).map(([n,i])=>{const s=Ma[n];if(s)return i instanceof Date?`${s}=${i.toUTCString()}`:typeof i=="boolean"?i?`${s}`:void 0:`${s}=${i}`}).filter(n=>!!n);return t.length!=0?`; ${t.join("; ")}`:""}function La(e,t){var n;return((n=e.match(`(^|;)\\s*${t}\\s*=\\s*([^;]+)`))==null?void 0:n.pop())??null}var mn=Oa(ka({_read:()=>document.cookie,_write:(e,t,n)=>{document.cookie=`${e}=${t}${Da(n)}`},getItem:(e,t)=>La(mn._read(t),e),setItem:(e,t,n)=>{mn._write(e,t,n)},removeItem:(e,t)=>{mn._write(e,"deleted",{...t,expires:new Date(0)})},key:(e,t)=>{let n=null,i=0;return mn._read(t).replace(/(?:^|;)\s*(.+?)\s*=\s*[^;]+/g,(s,a)=>(!n&&a&&i++===e&&(n=a),"")),n},getLength:e=>{let t=0;return mn._read(e).replace(/(?:^|;)\s*.+?\s*=\s*[^;]+/g,n=>(t+=n?1:0,"")),t},get length(){return this.getLength()}}));function Ea(e,t={}){var p;const n=t.storage||globalThis.localStorage,i=t.name||`storage-${Nr()}`;if(!n)return e;const s=t.storageOptions,a=t.serialize||JSON.stringify.bind(JSON),u=t.deserialize||JSON.parse.bind(JSON),d=n.getItem(i,s),m=typeof e[0]=="function"?b=>{try{const $=u(b);e[1](()=>$)}catch{}}:b=>{try{const $=u(b);e[1](zi($))}catch{}};let C=!0;if(d instanceof Promise?d.then(b=>C&&b&&m(b)):d&&m(d),typeof((p=t.sync)==null?void 0:p[0])=="function"){const b=typeof e[0]=="function"?e[0]:()=>e[0];t.sync[0]($=>{$.key!==i||($.url||globalThis.location.href)!==globalThis.location.href||$.newValue===a(Ie(b))||m($.newValue)})}return[e[0],typeof e[0]=="function"?b=>{var E;const $=e[1](b),F=b!=null?a($):b;return(E=t.sync)==null||E[1](i,F),b!=null?n.setItem(i,F,s):n.removeItem(i,s),C=!1,$}:(...b)=>{var F;e[1](...b);const $=a(Ie(()=>e[0]));(F=t.sync)==null||F[1](i,$),n.setItem(i,$,s),C=!1}]}var _a=de("<div id=freq-selector><div class=row><select name=frequency></select><input type=number class=live step=.1></div><div class=row><input type=button value=Swap><input type=number step=.1>"),Ia=de("<option> - ");function $a(){let[e,t]=Se(Ln),[n,i]=Ea(Te(e())),[s,a]=Te("approach");const u=ei();function d(){var g;const F=(g=u.data)==null?void 0:g.airspace;if(!F)return;let E=Object.entries(F.frequencies).find(([,w])=>w===e());E&&a(E[0])}gt(()=>d());function m(F){var g;a(F);const E=(g=u.data)==null?void 0:g.airspace;E&&E!=null&&E.frequencies&&F in(E==null?void 0:E.frequencies)&&t(E==null?void 0:E.frequencies[F])}function C(F){var g;t(F);const E=(g=u.data)==null?void 0:g.airspace;E&&E.frequencies&&a(Object.keys(E.frequencies).find(w=>E.frequencies[w]===F))}function p(){let F=e();C(n()),i(F)}function b(F){F.target instanceof HTMLInputElement&&C(parseFloat(F.target.value))}function $(F){F.key==="\\"&&p()}return Jn(()=>{document.addEventListener("keydown",$)}),Nt(()=>{document.removeEventListener("keydown",$)}),(()=>{var F=_a(),E=F.firstChild,g=E.firstChild,w=g.nextSibling,y=E.nextSibling,D=y.firstChild,A=D.nextSibling;return g.addEventListener("change",O=>m(O.target.value)),ee(g,(()=>{var O=ye(()=>{var Q,z;return!!((z=(Q=u.data)==null?void 0:Q.airspace)!=null&&z.frequencies)});return()=>{var Q;return O()?Object.entries((Q=u.data)==null?void 0:Q.airspace.frequencies).map(([z,N])=>(()=>{var x=Ia(),U=x.firstChild;return x.value=z,ee(x,z,U),ee(x,N,null),x})()):null}})()),w.$$input=b,D.$$click=p,A.$$input=O=>i(parseFloat(O.target.value)),Ee(()=>g.value=s()),Ee(()=>w.value=e()),Ee(()=>A.value=n()),F})()}Dn(["input","click"]);var Fa=de("<div class=points><p><b>Landings:</b> <!> (rate: once every <!> mins)</p><p><b>Takeoffs:</b> <!> (rate: once every <!> mins)");function xa(){const e=ua();return pe(Wt,{get when(){return e.data!==void 0},get children(){var t=Fa(),n=t.firstChild,i=n.firstChild,s=i.nextSibling,a=s.nextSibling,u=a.nextSibling,d=u.nextSibling;d.nextSibling;var m=n.nextSibling,C=m.firstChild,p=C.nextSibling,b=p.nextSibling,$=b.nextSibling,F=$.nextSibling;return F.nextSibling,ee(n,()=>e.data.landings,a),ee(n,()=>ht(e.data.landing_rate.rate.secs*1e3),d),ee(m,()=>e.data.takeoffs,b),ee(m,()=>ht(e.data.takeoff_rate.rate.secs*1e3),F),t}})}var Ua=de("<div class=flight><span class=callsign></span><span class=timer></span><button>Del"),qa=de("<form><h2>Order:</h2><label><span>Quantity:</span><input type=number name=quantity min=1 value=5></label><label><span>Flight kind:</span><select name=kind><option value=outbound>Outbound</option><option value=inbound>Inbound</option></select></label><label><span>Spawn in (secs):</span><input type=number name=spawn_at min=0 step=1 value=0></label><label><span>Stagger (secs):</span><input type=number name=stagger min=0 step=1 value=180></label><button type=submit>Add"),Ba=de("<button>Flights"),ja=de("<button>Close"),pi=de("<hr>"),Na=de("<h2>Scheduled"),gi=de("<div class=list>"),Wa=de("<h2>Ongoing"),Qa=de("<h2>Completed"),za=de('<div class="container border"><div class=flights>');function Va(e){switch(e){case"outbound":return"Depart";case"inbound":return"Arrive";default:return e}}function yi({flight:e}){const t=Zn();async function n(){(await fetch(`${Qe}${la(e.id)}`,{method:"DELETE"})).ok&&(await t.cancelQueries({queryKey:[Bt]}),await t.setQueryData([Bt],p=>(console.log({old:p}),p.filter(b=>b.id!==e.id))))}const[i,s]=Se(En);let a=Va(e.kind);e.status.type==="ongoing"?a=e.status.value:e.status.type==="completed"&&(a=e.status.value[0]);const u=ye(()=>i()===a);let d=ht(e.spawn_at.secs*1e3-new Date().getTime());e.status.type==="ongoing"?d=ht(new Date().getTime()-e.spawn_at.secs*1e3):e.status.type==="completed"&&(d=ht((e.status.value[1].secs-e.spawn_at.secs)*1e3));function m(){s(a)}return(()=>{var C=Ua(),p=C.firstChild,b=p.nextSibling,$=b.nextSibling;return C.$$click=m,ee(p,a),ee(b,d),$.$$click=n,Ee(F=>{var E=e.kind==="outbound",g=!!u();return E!==F.e&&p.classList.toggle("outbound",F.e=E),g!==F.t&&p.classList.toggle("selected",F.t=g),F},{e:void 0,t:void 0}),C})()}function Ka(){const e=Zn();async function t(i){const s=new URLSearchParams(i);await fetch(`${Qe}${aa}`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:s})}async function n(i){i.preventDefault();const s=i.target,a=new FormData(s),u=parseInt(a.get("quantity")),d=parseInt(a.get("stagger")),m=parseInt(a.get("spawn_at")),C=a.get("kind");await Promise.all(Array.from({length:u}).map((p,b)=>t({spawn_at:(m+b*d).toString(),kind:C}))),await e.cancelQueries({queryKey:[Bt]}),await e.invalidateQueries({queryKey:[Bt]}),await e.refetchQueries({queryKey:[Bt]}),m<=4&&(await e.cancelQueries({queryKey:[Yt]}),await e.invalidateQueries({queryKey:[Yt]}),await e.refetchQueries({queryKey:[Yt]}))}return(()=>{var i=qa();return i.addEventListener("submit",n),i})()}function Ga(){const[e,t]=Te(!1),n=oa();return(()=>{var i=za(),s=i.firstChild;return ee(s,pe(Wt,{get when(){return!e()},get children(){var a=Ba();return a.$$click=()=>t(!0),a}}),null),ee(s,pe(Wt,{get when(){return e()},get children(){return[(()=>{var a=ja();return a.$$click=()=>t(!1),a})(),pe(Ka,{}),pi(),Na(),(()=>{var a=gi();return ee(a,()=>n.data.filter(u=>u.status.type==="scheduled").map(u=>pe(yi,{flight:u}))),a})(),pi(),Wa(),(()=>{var a=gi();return ee(a,()=>n.data.filter(u=>u.status.type==="ongoing").map(u=>pe(yi,{flight:u}))),a})(),pi(),Qa(),(()=>{var a=gi();return ee(a,()=>n.data.filter(u=>u.status.type==="completed").map(u=>pe(yi,{flight:u}))),a})()]}}),null),i})()}Dn(["click"]);var Ha=de('<div class="container left"><div class=spacer>'),Ja=de("<div id=radar><div class=right><div class=bottom-right-buttons><button class=tts-toggle></button><button></button><button class=discard-button>Discard</button><button class=pause-button>Pause"),Ya=de("<div class=connection-message><h1>Connecting to server...</h1><h2>Retrying: ");function Xa(){const e=new ho;let[t,n]=Se(Zr),[i]=Pi(Ln),[s,a]=Pi(es);const u=ra(),d=Zn();async function m(g){await navigator.mediaDevices.getUserMedia(g)}function C(){e.startRecording(),n(!0)}async function p(){n(!1),e.stopRecording(async g=>{const w=await g.arrayBuffer();await fetch(`${Qe}/api/comms/voice?frequency=${i()}`,{body:w,method:"POST"}),await d.invalidateQueries({queryKey:[Gt],type:"all",exact:!0}),await d.refetchQueries({queryKey:[Gt],type:"all",exact:!0})})}function b(){e.abortRecording(),n(!1)}async function $(g){await fetch(`${Qe}/api/comms/text?frequency=${i()}`,{body:g,method:"POST"}),await d.invalidateQueries({queryKey:[Gt],type:"all",exact:!0}),await d.refetchQueries({queryKey:[Gt],type:"all",exact:!0})}Jn(async()=>{await m({audio:!0,video:!1}),document.addEventListener("keydown",g=>{g.key==="Insert"&&!t()?C():g.key==="Pause"&&F()}),document.addEventListener("keyup",g=>{g.key==="Insert"&&t()?p():g.key==="Delete"&&t()&&b()})});async function F(){await fetch(`${Qe}/api/pause`,{method:"POST"})}function E(){a(g=>!g)}return gt(()=>{console.log("connected?",u.data)}),[pe(Wt,{get when(){return u.data},get children(){return[(()=>{var g=Ha(),w=g.firstChild;return ee(g,pe(Ga,{}),w),ee(g,pe(xa,{}),null),ee(g,pe(pa,{sendMessage:$}),null),g})(),(()=>{var g=Ja(),w=g.firstChild,y=w.firstChild,D=y.firstChild,A=D.nextSibling,O=A.nextSibling,Q=O.nextSibling;return ee(g,pe(ya,{}),w),ee(w,pe(Aa,{}),y),ee(w,pe($a,{}),y),D.$$click=E,ee(D,()=>s()?"Disable TTS":"Enable TTS"),A.$$mouseup=p,A.$$mousedown=C,ee(A,()=>t()?"Recording...":"Talk"),O.$$click=b,Q.$$click=F,Ee(z=>{var N=!!s(),x=`talk-button ${t()?"recording":""}`;return N!==z.e&&D.classList.toggle("enabled",z.e=N),x!==z.t&&js(A,z.t=x),z},{e:void 0,t:void 0}),g})()]}}),pe(Wt,{get when(){return!u.data},get children(){var g=Ya(),w=g.firstChild,y=w.nextSibling;return y.firstChild,ee(y,Qe,null),g}})]}Dn(["click","mousedown","mouseup"]);const ps=document.getElementById("root"),Za=new Ko;if(!(ps instanceof HTMLElement))throw new Error("Root element not found. Did you forget to add it to your index.html? Or maybe the id attribute got misspelled?");Bs(()=>pe(Go,{client:Za,get children(){return pe(Xa,{})}}),ps);
//# sourceMappingURL=index-BGTnRiFv.js.map
